// Generated with grunt. Do not edit!


angular.$=angular.element,angular.$.prototype.parent=function(e){if(!e)return angular.$(this[0].parentNode);for(var t,i=[].slice.call(document.querySelectorAll(e)),n=this[0];"HTML"!==n.nodeName;){n=n.parentNode;-1===i.indexOf(n)||(t=n,n=document.documentElement)}return angular.$(t)};"use strict";var debug=!0;angular.module("seroApp.services",[]),angular.module("seroApp.directives",[]),angular.module("seroApp.controllers",[]),angular.module("pax.validations",[]);var seroApp=angular.module("seroApp",["ngRoute","ngResource","ngAnimate","ngMessages","ngSanitize","ui.bootstrap","ui.select2","ngFileUpload","ui.grid","ui.grid.edit","ui.grid.rowEdit","ui.grid.cellNav","ui.grid.resizeColumns","ui.grid.moveColumns","ui.grid.selection","seroApp.services","seroApp.directives","seroApp.controllers","pax.validations"]).config(["$routeProvider","$rootScopeProvider",function(e,t){t.digestTtl(500);t={templateUrl:"partials/projectTabs.html",controller:"ProjectTabsController"};e.when("/",{templateUrl:"partials/home.html",controller:"HomeController"}),e.when("/projects",{templateUrl:"partials/projects.html",controller:"ProjectsController"}),e.when("/projects/:projectId",t),e.when("/projects/:projectId/eiaspermits",t),e.when("/projects/:projectId/eiaspermits/:eiapermitId",t),e.when("/projects/:projectId/eiaspermits/:eiapermitId/documents",t),e.when("/projects/:projectId/eiaspermits/:eiapermitId/documents/:documentId",t),e.when("/projects/:projectId/eiaspermits/:eiapermitId/documents/:documentId/hearings",t),e.when("/projects/:projectId/eiaspermits/:eiapermitId/documents/:documentId/hearings/:hearingId",t),e.when("/projects/:projectId/externalaudits",t),e.when("/projects/:projectId/externalaudits/:externalauditId",t),e.when("/projects/:projectId/externalaudits/:externalauditId/documents",t),e.when("/projects/:projectId/externalaudits/:externalauditId/documents/:documentId",t),e.when("/projects/:projectId/auditsinspections",t),e.when("/projects/:projectId/auditsinspections/:auditinspectionId",t),e.when("/projects/:projectId/permitslicenses",t),e.when("/projects/:projectId/permitslicenses/:permitlicenseId",t);t={templateUrl:"partials/searchTabs.html",controller:"SearchTabsController"};e.when("/search",{redirectTo:"/search/projects"}),e.when("/search/projects",t),e.when("/search/eiaspermits",t),e.when("/search/permitslicenses",t),e.when("/search/auditsinspections",t),e.when("/search/externalaudits",t);e.when("/statistics",{redirectTo:"/statistics/projects"}),e.when("/statistics/projects",{templateUrl:"partials/statisticsTabs.html",controller:"StatisticsTabsController"}),e.when("/advanced/codes",{templateUrl:"partials/advancedCodes.html",controller:"AdvancedCodesController"}),e.when("/advanced/users",{templateUrl:"partials/advancedUsers.html",controller:"AdvancedUsersController"}),e.when("/advanced/emailOrders",{templateUrl:"partials/advancedEmailOrder.html",controller:"AdvancedEmailOrderController"}),e.when("/advanced/leadagencies",{templateUrl:"partials/advancedLeadAgency.html",controller:"AdvancedLeadAgenciesController"}),e.when("/advanced/pirking/statusEIA",{templateUrl:"partials/eiapermit-pirking.html",controller:"EiapermitPirkingController"}),e.when("/advanced/pirking/statusEA",{templateUrl:"partials/externalAudit-pirking.html",controller:"ExternalAudiPirkingController"}),e.when("/advanced/pirking/statusAI",{templateUrl:"partials/auditInspection-pirking.html",controller:"AuditInspecitionPirkingController"}),e.when("/advanced/pirking/statusPL",{templateUrl:"partials/permitlicense-pirking.html",controller:"PermitLicensePirkingController"}),e.when("/advanced/anonymize-data",{templateUrl:"partials/anonymize-data.html",controller:"DataAnonymizerController"}),e.when("/about",{templateUrl:"partials/about.html"}),e.when("/login",{templateUrl:"partials/login.html",controller:"UserController"}),e.when("/password/send",{templateUrl:"partials/passwordSend.html",controller:"LoginController"}),e.when("/password/reset/:token",{templateUrl:"partials/passwordReset.html",controller:"LoginController"}),e.when("/user",{templateUrl:"partials/user.html",controller:"UserController"}),e.when("/practitioners",{templateUrl:"partials/practitioners.html",controller:"PractitionersController"}),e.when("/public/practitioners",{templateUrl:"partials/publicPractitioners.html",controller:"PractitionersController"}),e.otherwise({redirectTo:"/"})}]).factory("authHttpResponseInterceptor",["$q","$location",function(t,i){return{responseError:function(e){return 0==i.path().indexOf("/password/reset/")||"/public/practitioners"==i.path()||401===e.status&&i.path("/login"),t.reject(e)}}}]).factory("unsavedDataProtection",["$q","$location",function(e,t){return{request:function(e){return"GET"!=e.method?window.globalWordCount="":window.interceptPageNavigation(),e}}}]).config(["$httpProvider",function(e){e.interceptors.push("authHttpResponseInterceptor"),e.interceptors.push("unsavedDataProtection")}]),SavingStateEnum={None:"None",LoadingNew:"Loading new",Loading:"Loading",Loaded:"Loaded",SavingStarted:"Saving started",SavingFinished:"Saving finished",SavingFailed:"Saving failed",Invalid:"Form not valid",MissingDependency:"Missing dependency in other form"},DisplayStateEnum={Show:!0,Hide:!1},ProjectTabEnum={Project:"Project",EiasPermits:"EIAS",PermitsLicenses:"Permits and Licenses",AuditsInspections:"Audits and Inspections",ExternalAudits:"External audits"},EiasPermitsTabEnum={EiaPermit:"EIA",Documents:"Documents",Hearings:"Hearings"},ExternalAuditsTabEnum={ExternalAudit:"External audit",Documents:"Documents",Hearings:"Hearings"},SearchTabEnum={Projects:"Projects",EiasPermits:"EIAS",PermitsLicenses:"Permits and Licenses",AuditsInspections:"Audits and Inspections",ExternalAudits:"External audits"},StatisticsTabEnum={Projects:"Projects",EiasPermits:"EIAS",AuditsInspections:"Audits and Inspections"},DocumentTagEnum={PermitLicenseApplicationForm:"Application form",PermitLicensePermitLicense:"Permit or license",PermitLicenseAttachments:"Attachment to the application"},fileUploadPattern="image/*,application/pdf,application/vnd.openxmlformats*,application/msword,text/plain,text/csv,application/octet-stream,binary/octet-stream,.xls,.xlsx,.docx",fileUploadNgfPattern="'image/*,application/pdf,application/vnd.openxmlformats*,application/msword,text/plain,text/csv,application/octet-stream,binary/octet-stream,.xls,.xlsx,.docx'",fileUploadMaxSize="50MB",exportObj={};function so(){console.log("ca")}function isCoordinateWithinUganda(e,t,i){if(!e||!t)return i(!1,{error:"undefined coordinates"});fetch("https://nominatim.openstreetmap.org/reverse?format=json&lat="+e+"&lon="+t,{headers:{"content-type":"application/json"},method:"GET",mode:"cors"}).then(function(e){return e.json()}).then(function(e){return e.address&&"ug"==e.address.country_code?i(!0,e):i(!1,e)}).catch(function(){return i(!1,{error:"network"})})}exportObj.exportMetaData={},exportObj.exportData=function(e,t){var i=this.exportMetaData[t];excelExport(e,i,t)},exportObj.exportMetaData.emailOrders={fieldmap:{id:"ID",foreign_id:"Document ID",foreign_type:"Document Type",order_status:"Order Status",subject:"Subject",unformatted_body:"Body",recipient:"Recipient",cc:"CC",bcc:"BCC",remarks_from_service:"Remarks from Service",remarks:"Remarks",number_of_attempts:"Number of Attempts",created_by:"Created By",formatted_created_at:"Created On",updated_by:"Updated By",formatted_updated_at:"Updated On",formatted_deleted_at:"Deleted On"},dateFields:["formatted_created_at","formatted_updated_at","formatted_deleted_at"]},exportObj.exportMetaData.auditAndInspection={fieldmap:{auditinspection_code:"Control number",auditinspection_status:"Audit and inspection status",auditinspection_year:"Year",auditinspection_type:"Activity",auditinspection_reason:"Type",lead_officer_name:"Lead officer",other_officer_name:"Other officers",auditinspection_date_carried_out:"Date carried out",auditinspection_days:"Number of days",auditinspection_external_participants:"Participants from lead agencies, facilities etc.",auditinspection_coordinated:"Multisectoral",lead_agency_name:"Lead agencies",auditinspection_date_action_taken:"Date of response",auditinspection_action_taken:"Response",auditinspection_advance_notice:"Advanced notice",auditinspection_findings:"Description of findings",auditinspection_performance_level:"Performance level",auditinspection_recommendations:"Recommendations",auditinspection_date_deadline:"Follow-up date",auditinspection_date_closing:"Activity ended",auditinspection_remarks:"Remarks",project_id:"Project ID",project_title:"Project name",category_description:"Category",district_district:"District",organisation_id:"Developer ID",developer_name:"Developer name"},dateFields:["auditinspection_date_carried_out","auditinspection_date_deadline","auditinspection_date_closing","auditinspection_date_action_taken"]},exportObj.exportMetaData.project={fieldmap:{project_id:"Project ID",project_title:"Project name",category_description:"Category",district_district:"District",project_location:"Location",project_longitude:"Longitude",project_latitude:"Latitude",project_has_industrial_waste_water:"Industrial waste water?",project_risk_level:"Risk level",project_contact_person:"Contact person",project_remarks:"Project remarks",organization_id:"Developer ID",developer_name:"Developer name",developer_tin:"TIN",organization_visiting_address:"Visiting address",organization_physical_address:"Physical address",organization_box_no:"PO box",organization_city:"City",organization_phone:"Phone",organization_fax:"Fax",organization_email:"Email",organization_remarks:"Developer remarks"},dateFields:[]},exportObj.exportMetaData.exportPermitsLicenses={fieldmap:{permitlicense_id:"Permit and license ID",permitlicense_regulation:"Regulation",permitlicense_date_submitted:"Date of submission",permitlicense_waste_license_type:"Waste license type",permitlicense_ecosystem:"Ecosystem",permitlicense_regulation_activity:"Regulation activity",permitlicense_area:"Area",permitlicense_unit:"Unit",permitlicense_approved_by_the_lc1:"LC1 approved",permitlicense_approved_by_the_dec:"DEC approved",permitlicense_application_number:"Application number",permitlicense_application_fee_receipt_number:"Application fee receipt number",permitlicense_date_feedback_to_applicants:"Date feedback to applicants",permitlicense_date_sent_officer:"Date feedback to applicants",permitlicense_date_sent_officer:"Date sent to the officer",permitlicense_date_sent_to_director:"Date sent to Director",permitlicense_date_sent_from_dep:"Date sent to team leader from dep",permitlicense_officer_assigned:"Team leader",permitlicense_handling_officer:"Officers to handle",permitlicense_officer_evaluation:"Application evaluation by officer",permitlicense_date_of_evaluation:"Date of evaluation",permitlicense_folio_no:"File and foliono.",permitlicense_inspection_recommended:"Inspection before decision ?",permitlicense_date_inspection:"Date of inspection",permitlicense_officer_recommend:"Recommendations by reviewer",permitlicense_fee_receipt_no:"Permit/license fee receipt number",permitlicense_date_fee_payed:"Date permit / license fee paid",permitlicense_date_sent_for_decision:"Date sent for decision",permitlicense_decision:"Decision taken",permitlicense_signature_on_permit_license:"Signature on permit / license",permitlicense_date_permit_license:"Date on the permit / licence",permitlicense_permit_license_no:"Permit / license number",permitlicense_date_permit_license_expired:"Date permit / license expired",permitlicense_documentation_files:"Soft copy",project_id:"Project ID",project_title:"Project name",category_name:"Category",district_district:"District",organisation_id:"Developer ID",organisation_name:"Developer name"},dateFields:["permitlicense_date_submitted","permitlicense_date_sent_to_director","permitlicense_date_sent_from_dep","permitlicense_date_sent_officer","permitlicense_date_of_evaluation","permitlicense_date_inspection","permitlicense_date_fee_payed","permitlicense_date_sent_for_decision","permitlicense_date_permit_license","permitlicense_date_permit_license_expired","permitlicense_date_feedback_to_applicants"]},exportObj.exportMetaData.eiaspermits={fieldmap:{eiapermit_id:"EIA and permit ID",eiapermit_status:"EIA status",practitioner_teamleader:"Practitioner team leader",cost:"Cost of the proposed development",eiapermit_cost_currency:"Cost currency",eiapermit_expected_jobs_created:"Expected jobs created",team_leader_name:"Team leader",personnel_officers_name:"Officers to handle",eias_permits_inspection_recommendation:"Inspection before decision?",eiapermit_date_inspection:"Date of inspection",eiapermit_officer_recommend:"Recommendations by reviewer",eiapermit_fee:"Expected fees",eiapermit_fee_currency:"Fee currency",eiapermit_date_sent_ded_approval:"Date sent for approval",eiapermit_decision:"Decision taken",eiapermit_date_decision:"Date for decision",eiapermit_date_fee_notification:"Date of invoicing",eiapermit_date_fee_payed:"Date invoice is payed",eiapermit_fee_receipt_no:"Fee receipt number",eiapermit_designation:"Signature on certificate",eiapermit_date_certificate:"Date on the certificate",eiapermit_certificate_no:"Certificate number",eiapermit_date_cancelled:"Certificate canceled date",eiapermit_remarks:"Remarks",file_metadata:"Soft copy of certificate",document_codes:"Documents",project_id:"Project ID",project_title:"Project name",category_description:"Category",district_district:"District",developer_id:"Developer ID",developer_name:"Developer name"},dateFields:["eiapermit_date_inspection","eiapermit_date_sent_ded_approval","eiapermit_date_decision","eiapermit_date_fee_notification","eiapermit_date_fee_payed","eiapermit_date_certificate","eiapermit_date_cancelled"]},exportObj.exportMetaData.externalAudit={fieldmap:{externalaudit_id:"External audit ID",externalaudit_status:"Status",ea_type:"Type of external audit",team_leader:"Team leader",handling_officers:"Officers to handle",verification_inspection:"Verification inspection?",date_inspection:"Date of inspection",date_response:"Date of response",file_metadata_response_id:"Response letter",review_findings:"Review findings",response:"Response",date_deadline_compliance:"Date for complete compliance",doc_code:"Documents",project_id:"Project ID",project_project_name:"Project name",category_name:"Category",district_district:"District",organisation_id:"Developer ID",organisation_name:"Developer name",invoice_fees:"Fees Invoiced",date_create_invoice:"Date of invoice creation",date_invoice_receipt_issued:"Date invoice was issued",date_invoice_payment:"Date invoice was paid"},dateFields:["date_inspection","date_response","date_create_invoice","date_invoice_receipt_issued","date_invoice_payment"]},exportObj.exportMetaData.practitioners={fieldmap:{practitioner:"Practitioner",tin:"TIN",organisation_name:"Organisation Name",visiting_address:"Address",box_no:"P.O. Box",phone:"Phone",fax:"Fax",email:"Email",qualifications:"Qualifications",expertise:"Expertise",remarks:"Remarks",year:"Year",date_of_entry:"Date of entry",cert_type:"Type of certificate",cert_no:"Certificate number",conditions:"Conditions",is_cancelled:"Cancelled?"},dateFields:[]};var regexIso8601=/^(\d{4}-\d{2}-\d{2} \d{2}\:\d{2}\:\d{2})$/;function convertDateStringsToDates(e){if("object"!=typeof e)return e;for(var t in e){var i,n,o;e.hasOwnProperty(t)&&("string"==typeof(i=e[t])&&(n=i.match(regexIso8601))?(o=n[0].replace(" ","T"),o+="Z",e[t]=new Date(o)):"object"==typeof i&&convertDateStringsToDates(i))}}seroApp.config(["$httpProvider",function(e){e.defaults.transformResponse.push(function(e){return convertDateStringsToDates(e),e})}]);var uploadFile=function(e,t,i,n,o,r){n.$setValidity("serverError",!0);var a=e.defer();return o&&!o.$error?(o.upload=i.upload({url:"/file/v1/upload",file:o,fields:{tag:r}}),o.upload.then(function(e){t(function(){o.result=e.data,a.resolve(o)})},function(e){0<e.status&&(n.$setValidity("serverError",!1),o.progress=0,o.error=e.status+": "+e.data.message,a.reject(o.error))}),o.upload.progress(function(e){o.progress=Math.min(100,parseInt(100*e.loaded/e.total))})):a.reject("Validation error."),a.promise};function addDays(e,t){e=new Date(e);return e.setDate(e.getDate()+t),e}function updateExternalAuditStatus(e,t){var i,n,o=null,r=_.groupBy(t,function(e){return e.type});return e.date_deadline_compliance?(console.log(e),e.status=147,!0):e.date_response?(e.status=146,!0):!!t.length&&(console.log(e),r[12]?(i=r[12][0],n={date_submitted:142,date_sent_director:143,date_sent_from_dep:144,date_sent_officer:145}):r[11]&&(i=r[11][0],n={date_submitted:137,date_sent_director:138,date_sent_from_dep:139,date_sent_officer:140,date_conclusion:141}),function(e,t){for(var i=Object.keys(t),n=0;n<i.length;n++)e[i[n]]&&(o=t[i[n]])}(i,n),e.status=o,!0)}function updateAuditInspectionStatus(e){return e.date_closing?e.status=75:e.date_received?e.status=74:e.date_deadline&&e.date_deadline<new Date?e.status=73:e.action_taken?e.status=72:e.date_carried_out&&(e.status=71),!![71,72,73,74,75].includes(e.status)}function updateEiaPermitStatus(e,t){var n,o,r,i=e.status,a=null;return e.date_cancelled?a=37:e.certificate_no?a=36:e.fee_receipt_no?a=35:e.date_fee_notification?a=34:e.date_decision?a=33:e.date_sent_ded_approval?a=32:(n=_.groupBy(t,function(e){return e.type}),o=0,r={13:{conclusion:59,date_dispatched:58,date_sent_officer:57,date_sent_from_dep:56,date_sent_director:55,date_submitted:54},10:{date_dispatched:31,date_sent_officer:30,date_sent_from_dep:29,date_sent_director:28,date_submitted:27},9:{conclusion:26,date_dispatched:25,date_sent_officer:24,date_sent_from_dep:23,date_sent_director:22,date_submitted:21},8:{conclusion:20,date_dispatched:19,date_sent_officer:18,date_sent_from_dep:17,date_sent_director:16,date_submitted:15}},_.forEach([13,10,9,8],function(t){var e=n[t];if(e){var i=0;return _.forEach(e,function(e){e.conclusion&&_.includes([78,79],e.conclusion)&&r[t].conclusion?i=r[t].conclusion:e.date_sent_officer?i=r[t].date_sent_officer:e.date_sent_from_dep?i=r[t].date_sent_from_dep:e.date_sent_director?i=r[t].date_sent_director:e.date_submitted&&(i=r[t].date_submitted),o<i&&(o=i)}),!1}}),0<o&&(a=o)),i!=a&&(e.status=a,!0)}function updatePermitLicenseStatus(e){return e.date_permit_license_expired&&e.date_permit_license_expired<new Date?e.status=157:e.permit_license_no?e.status=156:e.fee_receipt_no?e.status=154:e.date_sent_for_decision?e.status=155:e.date_of_evaluation?e.status=153:e.date_sent_officer?e.status=152:e.date_sent_from_dep?e.status=151:e.date_sent_to_director?e.status=150:e.date_submitted&&(e.status=149),!0}function showNavBarItems(e){var t=document.querySelectorAll(".navbar-nav, .navbar-right");t[0].style.display=t[1].style.display=e?"block":"none"}function toggleNavBarItems(e,t){if(0==(t=0==(t=t||!1)?{path:function(){return"/public/"}}:t).path().startsWith("/public/")||1==t.path().startsWith("/public/")&&"Not signed in"!=e.info.name)return showNavBarItems(!0);showNavBarItems(!1)}window.unsavedDataProtectionIgnoredSubPaths=["#/practitioners","/#/search","#/statistics","#/about","#/advanced","/#/user"],window.unsavedDataProtectionIgnoredExactPaths=["#/projects"],window.verifyEmailList=function(e){for(var t=(t=e).split(";"),i=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,n=[],o=0;o<t.length;o++)t[o]=t[o].trim(),""!=t[o]&&i.test(t[o])||n.push(t[o]);return 0==n.length},window.createEmailOrder=function(e,t,i,n){fetch("/api/v1/create-email-order/"+e.toLowerCase()+"/"+t+"/"+i).then(function(e){return e.json()}).then(function(t){fetch("/cron-route").then(function(e){return e.json()}).then(function(e){t.order_status=e.order_status,n(t)})})},window.emailerStatusObj=[{index:0,type:"non_existent",btnMsg:"Send email"},{index:1,type:"processing",btnMsg:"Sending email..."},{index:2,type:"processing",btnMsg:"Sending email..."},{index:3,type:"processed",btnMsg:"Email sent"},{index:4,type:"failed",btnMsg:"Email failed"}],Number.prototype.countDecimals=function(){return Math.floor(this.valueOf())!==this.valueOf()&&this.toString().split(".")[1].length||0},Number.prototype.truncateDecimal=function(e){e=new RegExp("(\\d+\\.\\d{"+e+"})(\\d)"),e=this.toString().match(e);return e?parseFloat(e[1]):this.valueOf()},Number.prototype.isOneOf=function(e){for(var t=e.length,i=0;i<t;i++){var n=this==e[i];if(n)break}return n},Date.prototype.humanDate=function(){return this.getDate()+" "+["January","February","March","April","May","June","July","August","September","October","November","December"][this.getMonth()]+" "+this.getFullYear()},Array.prototype.searchObj=function(t,i){return this.find(function(e){return e[t]==i})},window.getAppointmentDate=function(){var e=new Date;e.setDate(e.getDate()+7);e=e.humanDate().split(" ");return e[1]=e[1].substring(0,3),e.join(" ")};var controllers=angular.module("seroApp.controllers");controllers.controller("DatePickerController",["$scope",function(t){t.open=function(e){e.preventDefault(),e.stopPropagation(),t.opened=!0},t.datepickerOptions={startingDay:1}}]),controllers.controller("DatePickerSearchController",["$scope",function(t){t.open=function(e){e.preventDefault(),e.stopPropagation(),t.opened=!0},t.datepickerOptions={startingDay:1}}]),controllers.controller("NavBarController",["$scope","$location","UserInfo","EnvInfo",function(t,i,e,n){t.userinfo=e,t.$watch("userinfo",function(e,t){toggleNavBarItems(e,i)}),n(function(e){t.envinfo=e.env,t.lvVersion=e.lv_version}),t.isActive=function(e){return e===i.path()},t.isAdvancedActive=function(e){return 0==i.path().indexOf(e)},t.hasAccess=function(e){return!!t.userinfo.info.role_8}}]),controllers.controller("HomeController",["$scope","GeneralStatistics",function(t,e){t.counts={},e.get({},function(e){t.counts=e.counts})}]),controllers.controller("UserController",["$scope","UserInfo",function(e,t){showNavBarItems(!0),e.userinfo=t,e.userid_to_impersonate=null,e.impersonate=function(){e.userinfo.impersonate(e.userid_to_impersonate)}}]),controllers.controller("PractitionersController",["$scope","$filter","$animate","UserInfo","Practitioner","Valuelists",function(u,o,e,t,i,n){u.certificateYearMin=2e3,u.certificateYearMax=(new Date).getFullYear()+1,u.certificateYearValid=(new Date).getFullYear(),u.current=null,u.currentForm=null,u.userinfo=t,u.valuelists=n,i.query(function(e){u.practitioners=e}),setTimeout(function(){toggleNavBarItems(t)},3e3);function r(e,t,i,n){return!!e&&0<o("filter")(e,function(e){return e.cert_type==t&&(e.year===i&&(!(0<n&&e.conditions!=n)&&(!e.is_deleted&&!e.is_cancelled)))},!0).length}u.hasEiaTL=function(e){var t=r(e.practitioner_certificates,50,u.certificateYearValid,38);return e.cert_eia=t?"eia":null,t},u.hasEiaTM=function(e){var t=r(e.practitioner_certificates,50,u.certificateYearValid,39);return e.cert_eia=t?"eia":null,t},u.hasAuditTL=function(e){var t=r(e.practitioner_certificates,51,u.certificateYearValid,38);return e.cert_au=t?"audit":null,t},u.hasAuditTM=function(e){var t=r(e.practitioner_certificates,51,u.certificateYearValid,39);return e.cert_au=t?"audit":null,t},u.hasPartnershipEia=function(e){var t=r(e.practitioner_certificates,52,u.certificateYearValid,53);return e.cert_ep=t?"partnership":null,t},u.hasPartnershipEa=function(e){var t=r(e.practitioner_certificates,52,u.certificateYearValid,97);return e.cert_ep=t?"partnership":null,t},u.hasForeignPractitioner=function(e){var t="object"==typeof _.find(e.practitioner_certificates,"cert_type",148);return e.cert_ep=t?"ForeignPractitioner":null,t},u.newPractitioner=function(){var e;u.currentForm&&u.currentForm.$invalid?alert("Current form not valid. Can't create new practitioner."):(e=new i({practitioner_certificates:[],is_new:!0}),u.practitioners.unshift(e),u.toggleRow(e))},u.deletePractitioner=function(e,t){u.current=null,t.is_new||t.$delete(),u.practitioners.splice(e,1)},u.deleteCertificate=function(e,t,i){i.is_new?t.practitioner_certificates.splice(e,1):(i.year=2e3,i.date_of_entry=new Date,i.cert_type=51,i.cert_no="CC/EA/022/00",i.number=22,i.conditions=39,i.is_deleted=!0,u.currentForm.$setDirty(),setTimeout(function(){u.toggleRow(t,!0)},0))},u.newCertificate=function(e){var t={year:u.certificateYearValid,date_of_entry:new Date,is_new:!0};t.cert_no=u.certificateNumber(t),e.practitioner_certificates.unshift(t)},u.calculateCertificateNumber=function(e){e.cert_no=u.certificateNumber(e)},u.canSave=function(){return u.userinfo.info.role_6};u.toggleRow=function(t,e){if(!u.loading){if(u.canSave()&&u.current){var i=u.current,n=u.currentForm;if(console.log(n.$invalid,n,"what is not valid"),n.$invalid)return void alert("Form not valid. Can't save.");n.$dirty&&(i=i,u.canSave()&&(i.is_new?i.$save({},function(e){s(),a()}):i.$update({},function(e){console.log("save pract called",e),s(),a()})),n.$setPristine())}u.current!=t||e?t.is_new?u.current=t:(u.loading=t).$get({},function(e){s(),u.loading=null,u.current=t}):u.current=null}},u.setCurrentForm=function(e){u.currentForm=e},u.certificateNumber=function(e){var t="E",i=_.find(u.valuelists.practitionertype,{id:+e.cert_type});return"CC/"+(t=i?i.description1:t)+"/"+(e.number?("00"+e.number).slice(-3):"000")+"/"+(e.year?e.year.toString().substr(2):"00")},u.changeNumericBoolean=function(e){return 0===e?1:0};var a=function(){};function s(){}u.practitionerOrderBy=function(e){return e.person.trim().substring(e.person.trim().lastIndexOf(" "))},u.exportPractitioners=function(e){for(var t=e,i=[],n=t.length,o=0;o<n;o++)for(var r=t[o],a=r.practitioner_certificates,s=a.length,c=0;c<s;c++){var d=r.practitioner_title_id?u.valuelists.practitioner_title.searchObj("id",r.practitioner_title_id).description1:"",l=a[c];delete l.id,l.cert_type=function(e){var t={EIA:"Environmental Impact Assessor",EA:"Environmental Auditor",EP:"Environmental Partnership",FP:"Foreign Practitioner"},i=u.valuelists.practitionertype.searchObj("id",e),e=i?i.description1:null;try{return t[e]||i.description2}catch(e){return"NA"}}(l.cert_type),l.practitioner=d+" "+r.person,l.organisation_name=r.organisation_name,l.visiting_address=r.visiting_address,l.tin=r.tin,l.box_no=r.box_no+","+r.city,l.fax=r.fax,l.email=r.email,l.expertise=r.expertise,l.qualifications=r.qualifications,l.phone=r.phone,l.remark=r.remark,l.is_cancelled=l.is_cancelled?"YES":"NO",l.conditions=u.valuelists.practitionermembertype.searchObj("id",l.conditions).description2,l.date_of_entry=l.date_of_entry.humanDate(),i.push(l)}exportObj.exportData(i,"practitioners")},u.find=function(e,t,i){if(console.log(e,t,i),e&&t&&i)return _.find(e,t,i)}}]);var paginationCount=20,projectPagerOffset=0;controllers.controller("ProjectsController",["$scope","$location","$filter","Project","UserInfo",function(t,i,e,n,o){t.projectSearchTxt="Search",t.loadMoreProjectsTxt="Load more",t.projects=n.query({count:20}),t.projectsCount=0,n.query({countOnly:1},function(e){t.projectsCount=e[0]}),t.userinfo=o,t.goto=function(e){i.path(e)},t.canSave=function(){return t.userinfo.info.role_1},t.loadMoreProjects=function(){t.loadMoreProjectsTxt="Loading..",projectPagerOffset+=20,n.query({count:20,offset:projectPagerOffset,searchWord:t.searchWord},function(e){0!=e.length?(e=t.projects.concat(e),t.projects=e,t.loadMoreProjectsTxt="Load more"):t.hideProjectLoader=!0})},t.searchProjects=function(){t.projectSearchTxt="Searching...",n.query({count:20,searchWord:t.searchWord},function(e){t.hideProjectLoader=!1,t.projects=e,t.projectSearchTxt="Search"})}}]),controllers.controller("ProjectTabsController",["$scope","$routeParams","$location","$q","$timeout","ProjectFactory","UserInfo","Valuelists",function(r,e,t,a,i,s,n,o){r.SavingStateEnum=SavingStateEnum,r.ProjectTabEnum=ProjectTabEnum,r.routeParams=e,r.userinfo=n,r.valuelists=o,r.data=s,r.loadMoreBtnTxt="Load more",r.searchBtnTxt="search",r.organisations=[];var c;r.tab=(c=t.path(),_.contains(c,"eiaspermits")?ProjectTabEnum.EiasPermits:_.contains(c,"auditsinspections")?ProjectTabEnum.AuditsInspections:_.contains(c,"externalaudits")?ProjectTabEnum.ExternalAudits:_.contains(c,"permitslicenses")?ProjectTabEnum.PermitsLicenses:ProjectTabEnum.Project),r.goto=function(e){i(function(){t.path(e)})},r.auth={},r.auth.canSave=function(){return!1},r.saveCurrent=function(t,e,i){if(i=void 0!==i&&i,t.saveInProgress&&t.isNew)return(o=a.defer()).reject(),o.promise;t.saveInProgress=!0;var n,o=a.defer();return t.form.$pristine&&!i?(t.saveInProgress=!1,o.reject()):!t.form.$invalid&&!this.coordinateError||t.isNew&&i?(t.state=t.isNew?SavingStateEnum.LoadingNew:SavingStateEnum.SavingStarted,n=r.routeParams,i&&(n=_.omit(n,"auditinspectionId"),n=_.omit(n,"eiapermitId"),n=_.omit(n,"externalauditId")),s.save(n,e).then(function(e){_.isUndefined(t.form)||(t.state=t.isNew?SavingStateEnum.LoadingNew:SavingStateEnum.SavingFinished,t.form.$setPristine(),t.saveInProgress=!1,o.resolve(e))},function(e){console&&console.log("Error on server:",e),t.state=SavingStateEnum.SavingFailed,t.saveInProgress=!1})):(t.state=SavingStateEnum.Invalid,t.saveInProgress=!1,o.reject()),o.promise}}]),controllers.controller("ProjectController",["$scope","$q","ProjectFactory","Organisation","$timeout",function(a,e,t,n,i){function o(e){function t(t){var e="None";if(t.address.city)(i=_.find(a.valuelists.district,function(e){return e.description1.trim().toLowerCase()==t.address.city.trim().toLowerCase()}))&&(e=i.description1);else if(t.address.state)e=t.address.state;else for(var i,n=t.display_name.split(","),o=n.length,r=0;r<o;r++)(i=_.find(a.valuelists.district,function(e){return e.description1.trim().toLowerCase()==n[r].trim().toLowerCase()}))&&(e=i.description1);return e.trim().toLowerCase()}var i,n,o=_.find(a.valuelists.district,"id",parseInt(a.data.project.district_id)).description1.trim().toLowerCase(),r=t(e);if(o==r||(i=r,(n=["kwania","apac"]).includes(o)&&n.includes(i)))return a.districtState.isError=DisplayStateEnum.Hide,1;a.districtState.isError=DisplayStateEnum.Show,a.districtState.suggestion="apac"==t(e)?"Apac/Kwania":t(e)}var r;a.selectOrganisationMode=!1,a.isNewProject=!1,a.coordinateError=DisplayStateEnum.Hide,a.districtState={isError:DisplayStateEnum.Hide,suggestion:""},a.currentCoordinateObject={},a.coordinateNetworkIssues=DisplayStateEnum.Hide,a.checkingCoordinates=!1,a.currentLong="",a.currentLat="",a.parts={project:{form:null,state:SavingStateEnum.Loading},organisation:{form:null,state:SavingStateEnum.Loading}},a.newProjectExisitingOrganisation=function(e){a.selectOrganisationMode=!1,t.setOrganisation(e).then(function(e){a.parts.organisation.state=SavingStateEnum.Loaded}),0<t.project.id?(t.project.organisation_id=e.id,i(function(){a.saveCurrentProject(!0)})):t.createNewProject(e),a.parts.project.state=SavingStateEnum.Loaded},a.newProjectNewOganisation=function(){a.selectOrganisationMode=!1,t.createNewOrganisation(),0<t.project.id||t.createNewProject(a.data.organisation),a.parts.project.state=SavingStateEnum.Loaded,a.parts.organisation.state=SavingStateEnum.Loaded,a.parts.organisation.isNew=!0},a.loadMoreDevelopers=function(e){a.loadMoreBtnTxt="Loading...",paginationCount+=20;var t=a.data.searchWord,t=n.query({offset:paginationCount,searchWord:t}),i=a.organisations;t.$promise.then(function(e){var t=e[0].organisations,t=i.concat(t);a.organisations=t.sort(a.projectSortScript),a.currentCount=e[0].properties.currentCount,a.loadMoreBtnTxt="Load more"})},a.search=function(){a.searchBtnTxt="searching...";var e=a.data.searchWord;paginationCount=0,n.query({searchWord:e}).$promise.then(function(e){var t=e[0].organisations.sort(a.projectSortScript);a.organisations=t,a.totalCount=e[0].properties.totalCount,a.currentCount=e[0].properties.currentCount,a.searchBtnTxt="search"})},a.saveCurrentProject=function(e){var t;e=void 0!==e&&e,a.isNewProject?a.saveNewProjectAndNewOrganisation():(t=a.data.project,a.saveCurrent(a.parts.project,t,e).then(function(e){}))},a.saveCurrentOrganisation=function(){var t,e;a.isNewProject?a.saveNewProjectAndNewOrganisation():(t=a.data.project,e=a.data.organisation,a.saveCurrent(a.parts.organisation,e).then(function(e){e.id!==t.organisation_id&&(t.organisation_id=e.id,a.saveCurrentProject(!0))}))},a.saveNewProjectAndNewOrganisation=function(){var t,e,i=a.parts.project,n=a.parts.organisation;return i.form.$invalid||this.coordinateError?(a.parts.project.state=SavingStateEnum.Invalid,void(n.form.$dirty&&(a.parts.organisation.state=SavingStateEnum.MissingDependency))):i.form.$valid&&n.form.$invalid?(a.parts.project.state=SavingStateEnum.MissingDependency,void(a.parts.organisation.state=SavingStateEnum.Invalid)):void(i.form.$valid&&n.form.$valid&&(t=a.data.project,e=a.data.organisation,n.form.$pristine?(t.organisation_id=e.id,a.saveCurrent(i,t).then(function(e){a.goto("/projects/"+e.id)})):a.saveCurrent(n,e).then(function(e){t.organisation_id=e.id,a.saveCurrent(i,t).then(function(e){a.goto("/projects/"+e.id)})})))},a.auth.canSave=function(e){return"has_industrial_waste_water"!==e?a.userinfo.info.role_1:a.userinfo.info.role_3},a.auth.canDelete=function(){return!a.isNewProject&&(a.parts.project.state!=SavingStateEnum.Loading&&(!(0<a.data.eiaspermits.length||0<a.data.auditsinspections.length)&&a.auth.canSave()))},a.deleteProject=function(){t.deleteProject(a.routeParams).then(function(){a.goto("/projects")})},a.changeDeveloper=function(){a.selectOrganisationMode=!0,n.query().$promise.then(function(e){a.organisations=e[0].organisations.sort(a.projectSortScript),a.totalCount=e[0].totalCount,a.currentCount=e[0].currentCount})},a.verifyCoordinates=function(e,t){var i;function n(e){e&&(a.coordinateError=e),a.checkingCoordinates=e}t&&a.parts.project.state==SavingStateEnum.Loading||(i=a.data.project.latitude&&a.data.project.latitude.trim(),t=a.data.project.longitude&&a.data.project.longitude.trim(),a.data.project.latitude=i,a.data.project.longitude=t,!a.isNewProject||i||t?a.parts.project.state!=SavingStateEnum.Loading&&(a.currentLong==t&&a.currentLat==i||(i||t?(a.currentLat=i,a.currentLong=t,n(!0),isCoordinateWithinUganda(i,t,function(e,t){a.$apply(function(){e?(a.currentCoordinateObject=t,a.coordinateError=DisplayStateEnum.Hide,o(t),a.saveCurrentProject()):(document.getElementById("latitude").classList.remove("ng-valid"),document.getElementById("longitude").classList.remove("ng-valid"),a.coordinateError=DisplayStateEnum.Show,"network"==t.error?a.coordinateNetworkIssues=DisplayStateEnum.Show:a.coordinateNetworkIssues=DisplayStateEnum.Hide),n(!1)})})):a.coordinateError=DisplayStateEnum.Hide)):a.coordinateError=DisplayStateEnum.Hide)},a.onDistrictChange=function(){o(a.currentCoordinateObject),a.saveCurrentProject()},a.splitCoordinates=function(t){setTimeout(function(){var e=document.getElementById(t).value.split(",");e.length<2||(a.data.project.latitude=e[0],a.data.project.longitude=e[1])},0)},"new"==a.routeParams.projectId?(a.selectOrganisationMode=!0,a.isNewProject=!0,a.parts.project.isNew=!0,t.empty(),n.query().$promise.then(function(e){a.organisations=e[0].organisations.sort(a.projectSortScript),a.totalCount=e[0].properties.totalCount,a.currentCount=e[0].properties.currentCount})):((r=t.retrieveProjectData(a.routeParams))[0].then(function(){a.parts.project.state=SavingStateEnum.Loaded}),r[1].then(function(){a.parts.organisation.state=SavingStateEnum.Loaded})),a.projectSortScript=function(e,t){return e.projectCount<t.projectCount?1:e.projectCount>t.projectCount?-1:0}}]),controllers.controller("EiasPermitsTabsController",["$scope","$location","ProjectFactory",function(i,e,t){i.fileUploadPattern=fileUploadPattern,i.fileUploadNgfPattern=fileUploadNgfPattern,i.fileUploadMaxSize=fileUploadMaxSize,i.EiasPermitsTabEnum=EiasPermitsTabEnum,i.parts={eiapermits:{state:SavingStateEnum.None},eiapermit:{form:null,state:SavingStateEnum.None},documents:{state:SavingStateEnum.None},document:{form:null,state:SavingStateEnum.None},hearings:{state:SavingStateEnum.None},hearing:{form:null,state:SavingStateEnum.None}};var n;i.eptab=(n=e.path(),_.contains(n,"hearings")?EiasPermitsTabEnum.Hearings:_.contains(n,"documents")?EiasPermitsTabEnum.Documents:EiasPermitsTabEnum.EiaPermit),i.preventClickIfDisabled=function(e,t){e&&t.preventDefault()},i.stopPropagation=function(e){e.stopPropagation()},i.openEiapermit=function(e,t){i.routeParams.eiapermitId==e?i.goto("/projects/"+i.data.project.id+"/eiaspermits"):i.routeParams.eiapermitId||i.goto("/projects/"+i.data.project.id+"/eiaspermits/"+e)},i.openEiapermitDocument=function(e,t){i.routeParams.documentId==e?i.goto("/projects/"+i.data.project.id+"/eiaspermits/"+i.data.eiapermit.id+"/documents"):i.routeParams.documentId||i.goto("/projects/"+i.data.project.id+"/eiaspermits/"+i.data.eiapermit.id+"/documents/"+e)},i.openEiapermitDocumentHearing=function(e,t){i.routeParams.hearingId==e?i.goto("/projects/"+i.data.project.id+"/eiaspermits/"+i.data.eiapermit.id+"/documents/"+i.data.document.id+"/hearings"):i.routeParams.hearingId||i.goto("/projects/"+i.data.project.id+"/eiaspermits/"+i.data.eiapermit.id+"/documents/"+i.data.document.id+"/hearings/"+e)},i.isDocumentsDisabled=function(e){return!!i.isDisabled(e)||i.parts.documents.state==SavingStateEnum.Loading},i.isHearingsDisabled=function(e){return!!i.isDisabled(e)||i.parts.hearings.state==SavingStateEnum.Loading},i.isDisabled=function(e){return _.isUndefined(e)},i.downloadFileUrl=function(e){return"/file/v1/download/"+e},i.updateStatus=function(e){e=updateEiaPermitStatus(e,i.data.documents);return e&&i.parts.eiapermit.form&&i.parts.eiapermit.form.$setDirty(),e},i.loadEiaPermitWithDocuments=function(){i.parts.eiapermit.state=SavingStateEnum.Loading,i.parts.documents.state=SavingStateEnum.Loading;var e=t.retrieveEiaPermit(i.routeParams);e[0].then(function(e){i.parts.eiapermit.state=SavingStateEnum.Loaded}),e[1].then(function(e){i.parts.documents.state=SavingStateEnum.Loaded})},i.parts.eiapermits.state=SavingStateEnum.Loading,t.retrieveProjectData(i.routeParams)[2].then(function(e){i.parts.eiapermits.state=SavingStateEnum.Loaded,_.isUndefined(i.routeParams.eiapermitId)||i.loadEiaPermitWithDocuments()})}]),controllers.controller("EiasPermitsController",["$scope","ProjectFactory","$timeout","Upload","$q","$location",function(i,e,t,n,o,r){i.showUploadingCertificate=!1,i.invalidRecipients=!1,i.shouldShowEiaPermit=function(e){return i.parts.eiapermit.state!=SavingStateEnum.Loading&&i.routeParams.eiapermitId==e.id},i.customValidation=function(e){return e.email_contact&&!window.verifyEmailList(e.email_contact)?!(i.invalidRecipients=!0):!(i.invalidRecipients=!1)},i.saveCurrentEiaPermit=function(e){var t=e.is_new;if(!i.customValidation(e))return!1;t||i.updateStatus(e),i.saveCurrent(i.parts.eiapermit,e,t).then(function(e){t&&i.goto("/projects/"+i.data.project.id+"/eiaspermits/"+e.id)})},i.newEiaPermit=function(){i.parts.eiapermit.state=SavingStateEnum.LoadingNew,e.createNewEiaPermit(i.data.project),i.saveCurrentEiaPermit(i.data.eiapermit)},i.deleteEiaPermit=function(){e.deleteEiaPermit(i.routeParams),i.goto("/projects/"+i.data.project.id+"/eiaspermits")},i.uploadCertificate=function(e){e&&(i.showUploadingCertificate=!0,i.certificateFile=e[0],uploadFile(o,t,n,i.parts.eiapermit.form.certificate,i.certificateFile).then(function(e){i.data.eiapermit.file_metadata_id=e.result.id,i.parts.eiapermit.form.certificate.$setDirty(),i.saveCurrentEiaPermit(i.data.eiapermit)},function(e){}))},i.deleteCertificate=function(){i.showUploadingCertificate=!1,i.data.eiapermit.file_metadata_id=null,i.parts.eiapermit.form.certificate.$setDirty(),i.saveCurrentEiaPermit(i.data.eiapermit)},i.criteriaMatchOfficer1=function(e){return function(e){return!0}},i.criteriaMatchOfficer=function(e){return function(e){return!0}},i.modifyInputDecimals=function(){var e=i.data.eiapermit.fee||"",t=i.data.eiapermit.expected_jobs_created||"",e=parseFloat(e.replaceAll(",",".")),t=parseFloat(t.replaceAll(",","."));e&&2<e.countDecimals()&&(i.data.eiapermit.fee=e.truncateDecimal(2)),t&&1<t.countDecimals()&&(i.data.eiapermit.expected_jobs_created=t.truncateDecimal(1))},i.auth.canSave=function(e){if(i.data.eiapermit.is_new&&i.parts.eiapermit.state==SavingStateEnum.SavingStarted)return!1;switch(e){case"new":case"delete":return i.userinfo.info.role_1;case"teamleader_id":case"practitioner_id":case"cost":case"cost_currency":case"recipient_email":case"expected_jobs_created":return i.userinfo.info.role_1;case"personnel":return i.userinfo.info.role_2;case"inspection_recommended":case"date_inspection":case"officer_recommend":case"fee":case"fee_currency":case"remarks":return i.userinfo.info.role_3;case"date_fee_notification":case"date_fee_payed":case"fee_receipt_no":return i.userinfo.info.role_4;case"decision":case"date_decision":case"designation":case"date_certificate":case"certificate_no":case"date_cancelled":case"user_id":case"date_sent_ded_approval":return i.userinfo.info.role_5;default:return!1}}}]),controllers.controller("EiasPermitsDocumentsController",["$scope","ProjectFactory","$timeout","Upload","$q","$location","EiaPermitSearch",function(o,r,t,i,n,e,a){o.failedToSendMail=!1,o.listNumberAlreadyExists=!1,o.ep=o.data.eiapermit,o.documentCode="",o.shouldShowDocument=function(e){return o.parts.document.state!=SavingStateEnum.Loading&&o.routeParams.documentId==e.id},o.moveButton={},o.moveDocument=function(){o.moveButton.error="",a.query({eiapermit_id:o.moveButton.id},function(e){var t,i,n;1<=e.length?(t=e[0].project_id,i=e[0].eiapermit_id,n=o.data.document.id,r.moveDocument(o.routeParams,o.moveButton.id).then(function(){o.updateStatusBasedOnDocument(),o.goto("/projects/"+t+"/eiaspermits/"+i+"/documents/"+n)})):o.moveButton.error="Not a valid EIA ID."})},o.updateStatusBasedOnDocument=function(){o.updateStatus(o.data.eiapermit)&&o.data.eiapermit.$update(o.routeParams,function(e){},function(){})},o.saveCurrentDocument=function(e){if(o.listNumberAlreadyExists)return!1;var t=e.is_new;o.saveCurrent(o.parts.document,e).then(function(e){o.updateStatusBasedOnDocument(),t&&o.goto("/projects/"+o.data.project.id+"/eiaspermits/"+o.data.eiapermit.id+"/documents/"+e.id)})},o.newDocument=function(){o.parts.document.state=SavingStateEnum.LoadingNew,r.createNewDocument(o.data.eiapermit)},o.deleteDocument=function(){r.deleteDocument(o.routeParams).then(function(){o.updateStatusBasedOnDocument(),o.goto("/projects/"+o.data.project.id+"/eiaspermits/"+o.data.eiapermit.id+"/documents")})},o.uploadAttachment=function(e){e&&(o.showUploadingAttachment=!0,o.attachmentFile=e[0],uploadFile(n,t,i,o.parts.document.form.attachment,o.attachmentFile).then(function(e){o.data.document.file_metadata_id=e.result.id,o.parts.document.form.attachment.$setDirty(),o.saveCurrentDocument(o.data.document)},function(e){}))},o.uploadResponseDocument=function(e){e&&(o.showUploadingResponseDocument=!0,o.responseDocumentFile=e[0],uploadFile(n,t,i,o.parts.document.form.response_document,o.responseDocumentFile).then(function(e){o.data.document.file_metadata_response_id=e.result.id,o.parts.document.form.response_document.$setDirty(),o.saveCurrentDocument(o.data.document)},function(e){}))},o.deleteAttachment=function(){o.showUploadingAttachment=!1,o.data.document.file_metadata_id=null,o.parts.document.form.attachment.$setDirty(),o.saveCurrentDocument(o.data.document)},o.deleteResponseDocument=function(){o.showUploadingResponseDocument=!1,o.data.document.file_metadata_response_id=null,o.parts.document.form.response_document.$setDirty(),o.saveCurrentDocument(o.data.document)},o.calculateNumberOfCopiesOfDocument=function(){o.data.document.director_copy_no=1,o.data.document.coordinator_copy_no=o.data.document.sub_copy_no-1},o.calculateDocumentCode=function(){var e=_.find(o.valuelists.documenttype,{id:parseInt(o.data.document.type)}),t=o.data.document.id,i=(e?e.description1:"")+(o.data.document.number||"");fetch("/api/v1/document/code-check/"+i).then(function(e){return e.json()}).then(function(e){o.$apply(function(){!e.code_exists||e.code_exists&&t==e.document_id?(o.listNumberAlreadyExists=!1,o.data.document.code=i,o.setDefaultDocumentConclusion()):(o.documentCode=i,o.listNumberAlreadyExists=!0)})})},o.setDefaultDocumentConclusion=function(){0<=_.indexOf(["8","9"],o.data.document.type)?o.data.document.conclusion=80:o.data.document.conclusion=81},o.getEmailerObj=function(e){e=e.email_order&&e.email_order.order_status?e.email_order.order_status:0;return window.emailerStatusObj[e]},o.createEmailOrder=function(e,t,i,n){o.data.document.email_order={},o.data.document.email_order.order_status=1,window.createEmailOrder(e,t,i,function(e){o.$apply(function(){0==e.order_status?(o.data.document.email_order=null,o.failedToSendMail=!0):o.data.document.email_order=e,x})})},o.isDisabledBasedOnRule=function(e){switch(e){case"document.conclusion":return 81==o.data.document.conclusion&&9!=o.data.document.type&&8!=o.data.document.type;case"document.type":return 10==o.data.document.type;default:return!1}},o.auth.canSave=function(e){if(o.data.document.is_new&&o.parts.document.state==SavingStateEnum.SavingStarted)return!1;switch(e){case"new":case"delete":return o.userinfo.info.role_1;case"can_email":case"document.date_submitted":case"document.sub_copy_no":case"document.title":case"document.type":case"document.number":case"document.code":case"document.consultent":case"document.director_copy_no":case"document.date_sent_director":case"document.coordinator_copy_no":case"document.date_copies_coordinator":case"document.date_next_appointment":case"document.folio_no":return o.userinfo.info.role_1;case"document.date_sent_officer":case"document.remarks_team_leader":return o.userinfo.info.role_2;case"document.file_metadata_response_id":case"document.conclusion":case"document.date_conclusion":case"document.remarks":return o.userinfo.info.role_3;case"document.remarks_director":case"document.date_sent_from_dep":return o.userinfo.info.role_5;case"move":return o.userinfo.info.role_8;default:return!1}},o.loadDocumentWithHearings=function(){o.parts.document.state=SavingStateEnum.Loading,o.parts.hearings.state=SavingStateEnum.Loading;var e=r.retrieveDocument(o.routeParams);e[0].then(function(e){o.parts.document.state=SavingStateEnum.Loaded}),e[1].then(function(e){o.parts.hearings.state=SavingStateEnum.Loaded})},o.parts.document,SavingStateEnum.Loading,r.retrieveProjectData(o.routeParams)[2].then(function(e){r.retrieveEiaPermit(o.routeParams)[1].then(function(e){o.parts.documents.state=SavingStateEnum.Loaded,_.isUndefined(o.routeParams.documentId)||o.loadDocumentWithHearings()})})}]),controllers.controller("EiasPermitsHearingsController",["$scope","ProjectFactory","$timeout","Upload","$q","$location",function(i,t,n,o,r,e){i.shouldShowHearing=function(e){return i.parts.hearing.state!=SavingStateEnum.Loading&&i.routeParams.hearingId==e.id},i.saveCurrentHearing=function(e){var t=e.is_new;i.saveCurrent(i.parts.hearing,e).then(function(e){t&&i.goto("/projects/"+i.data.project.id+"/eiaspermits/"+i.data.eiapermit.id+"/documents/"+i.data.document.id+"/hearings/"+e.id)})},i.newHearing=function(){i.parts.hearing.state=SavingStateEnum.LoadingNew,t.createNewHearing(i.data.document)},i.deleteHearing=function(){t.deleteHearing(i.routeParams).then(function(){i.goto("/projects/"+i.data.project.id+"/eiaspermits/"+i.data.eiapermit.id+"/documents/"+i.data.document.id)})},i.uploadAttachment=function(e){e&&(i.showUploadingAttachment=!0,i.attachmentFile=e[0],uploadFile(r,n,o,i.parts.hearing.form.attachment,i.attachmentFile).then(function(e){i.data.hearing.file_metadata_id=e.result.id,i.parts.hearing.form.attachment.$setDirty(),i.saveCurrentHearing(i.data.hearing)},function(e){}))},i.deleteAttachment=function(){i.showUploadingAttachment=!1,i.data.hearing.file_metadata_id=null,i.parts.hearing.form.attachment.$setDirty(),i.saveCurrentHearing(i.data.hearing)},i.isDisabledBasedOnRule=function(e){return"hearing.district_id"===e&&(7!=i.data.hearing.lead_agency&&8!=i.data.hearing.lead_agency&&!(i.data.hearing.district_id=null))},i.auth.canSave=function(e){if(i.data.hearing.is_new&&i.parts.hearing.state==SavingStateEnum.SavingStarted)return!1;switch(e){case"new":case"delete":case"hearing.date_dispatched":case"hearing.lead_agency":case"hearing.district_id":case"hearing.date_expected":case"hearing.date_received":case"hearing.recommendations":case"hearing.document_id":return i.userinfo.info.role_1;case"hearing.remarks":return i.userinfo.info.role_3;default:return!1}},i.loadHearing=function(){i.parts.hearing.state=SavingStateEnum.Loading,t.retrieveHearing(i.routeParams)[0].then(function(e){i.parts.hearing.state=SavingStateEnum.Loaded})},i.loadDocumentWithHearings=function(){i.parts.document.state=SavingStateEnum.Loading,i.parts.hearings.state=SavingStateEnum.Loading;var e=t.retrieveDocument(i.routeParams);e[0].then(function(e){i.parts.document.state=SavingStateEnum.Loaded}),e[1].then(function(e){i.parts.hearings.state=SavingStateEnum.Loaded,_.isUndefined(i.routeParams.hearingId)||i.loadHearing()})},t.retrieveProjectData(i.routeParams)[2].then(function(e){t.retrieveEiaPermit(i.routeParams)[1].then(function(e){i.parts.documents.state=SavingStateEnum.Loaded,_.isUndefined(i.routeParams.documentId)||i.loadDocumentWithHearings()})})}]),controllers.controller("ExternalAuditsTabsController",["$scope","$location","ProjectFactory",function(i,e,t){i.fileUploadPattern=fileUploadPattern,i.fileUploadNgfPattern=fileUploadNgfPattern,i.fileUploadMaxSize=fileUploadMaxSize,i.ExternalAuditsTabEnum=ExternalAuditsTabEnum,i.parts={externalaudits:{state:SavingStateEnum.None},externalaudit:{form:null,state:SavingStateEnum.None},documents:{state:SavingStateEnum.None},document:{form:null,state:SavingStateEnum.None},hearings:{state:SavingStateEnum.None},hearing:{form:null,state:SavingStateEnum.None}};var n;i.eatab=(n=e.path(),_.contains(n,"hearings")?EiasPermitsTabEnum.Hearings:_.contains(n,"documents")?ExternalAuditsTabEnum.Documents:ExternalAuditsTabEnum.ExternalAudit),i.openExternalaudit=function(e,t){i.routeParams.externalauditId==e?i.goto("/projects/"+i.data.project.id+"/externalaudits"):i.routeParams.externalauditId||i.goto("/projects/"+i.data.project.id+"/externalaudits/"+e)},i.openExternalauditDocument=function(e,t){i.routeParams.documentId==e?i.goto("/projects/"+i.data.project.id+"/externalaudits/"+i.data.externalaudit.id+"/documents"):i.routeParams.documentId||i.goto("/projects/"+i.data.project.id+"/externalaudits/"+i.data.externalaudit.id+"/documents/"+e)},i.preventClickIfDisabled=function(e,t){e&&t.preventDefault()},i.stopPropagation=function(e){e.stopPropagation()},i.isDocumentsDisabled=function(e){return!!i.isDisabled(e)||i.parts.documents.state==SavingStateEnum.Loading},i.isHearingsDisabled=function(e){return!!i.isDisabled(e)||i.parts.hearings.state==SavingStateEnum.Loading},i.isDisabled=function(e){return _.isUndefined(e)},i.downloadFileUrl=function(e){return"/file/v1/download/"+e},i.updateStatus=function(e){e=updateExternalAuditStatus(e,i.data.documents_ea);return e&&i.parts.externalaudit.form&&i.parts.externalaudit.form.$setDirty(),e},i.loadExternalAuditWithDocuments=function(){i.parts.externalaudit.state=SavingStateEnum.Loading,i.parts.documents.state=SavingStateEnum.Loading;var e=t.retrieveExternalAudit(i.routeParams);e[0].then(function(e){i.parts.externalaudit.state=SavingStateEnum.Loaded}),e[1].then(function(e){i.parts.documents.state=SavingStateEnum.Loaded})},i.parts.externalaudits.state=SavingStateEnum.Loading,t.retrieveProjectData(i.routeParams)[5].then(function(e){i.parts.externalaudits.state=SavingStateEnum.Loaded,_.isUndefined(i.routeParams.externalauditId)||i.loadExternalAuditWithDocuments()})}]),controllers.controller("ExternalAuditsController",["$scope","ProjectFactory","$timeout","Upload","$q","$location",function(i,e,t,n,o,r){i.showUploadingResponseDocument=!1,i.invalidRecipients=!1,i.shouldShowExternalAudit=function(e){return console.log("was called"),i.parts.externalaudit.state!=SavingStateEnum.Loading&&i.routeParams.externalauditId==e.id},i.saveCurrentExternalAudit=function(e){var t=e.is_new;t||i.updateStatus(e),i.saveCurrent(i.parts.externalaudit,e,t).then(function(e){t&&i.goto("/projects/"+i.data.project.id+"/externalaudits/"+e.id)})},i.newExternalAudit=function(){i.parts.externalaudit.state=SavingStateEnum.LoadingNew,e.createNewExternalAudit(i.data.project)},i.deleteExternalAudit=function(){e.deleteExternalAudit(i.routeParams),i.goto("/projects/"+i.data.project.id+"/externalaudits")},i.uploadResponseDocument=function(e){e&&(i.showUploadingResponseDocument=!0,i.responseDocumentFile=e[0],uploadFile(o,t,n,i.parts.externalaudit.form.response_document,i.responseDocumentFile).then(function(e){i.data.externalaudit.file_metadata_response_id=e.result.id,i.parts.externalaudit.form.response_document.$setDirty(),i.saveCurrentExternalAudit(i.data.externalaudit)},function(e){}))},i.deleteResponseDocument=function(){i.showUploadingResponseDocument=!1,i.data.externalaudit.file_metadata_response_id=null,i.parts.externalaudit.form.response_document.$setDirty(),i.saveCurrentExternalAudit(i.data.externalaudit)},i.criteriaMatchOfficer1=function(e){return function(e){return!0}},i.criteriaMatchOfficer=function(e){return function(e){return!0}},i.auth.canSave=function(e){if(i.data.externalaudit.is_new&&i.parts.externalaudit.state==SavingStateEnum.SavingStarted)return!1;switch(e){case"date_invoice_payment":case"date_invoice_receipt_issued":case"date_create_invoice":case"invoice_fees":return i.userinfo.info.role_4;case"new":return i.userinfo.info.role_1;case"teamleader_id":case"practitioner_id":case"type":case"recipient_email":return i.userinfo.info.role_1;case"personnel":case"remarks_team_leader":return i.userinfo.info.role_2;case"verification_inspection":case"date_inspection":case"date_response":case"fee":case"fee_currency":case"remarks":case"review_findings":case"response":case"date_deadline_compliance":case"delete":case"upload_documentation_response_letter":case"delete_documentation_response_letter":return i.userinfo.info.role_3;case"user_id":return i.userinfo.info.role_5;default:return!1}},i.filterByDateSubmission=function(e){if(console.log("filter called"),e.length||e[0].documents)return e.sort(function(e,t){return console.log("sort is running"),(e.documents&&e.documents[0]?e.documents[0].date_submitted:"")<(t.documents&&t.documents[0]?t.documents[0].date_submitted:"")?-1:1}),e.reverse()},i.customValidation=function(e){return e.email_contact&&!window.verifyEmailList(e.email_contact)?!(i.invalidRecipients=!0):!(i.invalidRecipients=!1)},i.saveCurrentEmailContact=function(e){if(!i.customValidation(e))return!1;i.saveCurrentExternalAudit(e)}}]),controllers.controller("ExternalAuditsDocumentsController",["$scope","ProjectFactory","$timeout","Upload","$q","$location","ExternalAuditSearch",function(o,r,t,i,n,e,a){o.ep=o.data.eiaspermits[0],o.ea=o.data.externalaudit,o.listNumberAlreadyExists=!1,o.documentCode="",o.shouldShowDocument=function(e){return o.parts.document.state!=SavingStateEnum.Loading&&o.routeParams.documentId==e.id},o.moveButton={},o.moveDocument=function(){o.moveButton.error="",a.query({externalaudit_id:o.moveButton.id},function(e){var t,i,n;1<=e.length?(t=e[0].project_id,i=e[0].externalaudit_id,n=o.data.document_ea.id,console.log(t,i,n),r.moveDocumentEA(o.routeParams,o.moveButton.id).then(function(){o.updateStatusBasedOnDocument(),o.goto("/projects/"+t+"/externalaudits/"+i+"/documents/"+n)})):o.moveButton.error="Not a valid EA ID."})},o.updateStatusBasedOnDocument=function(){o.updateStatus(o.data.externalaudit)&&o.data.externalaudit.$update(o.routeParams,function(e){},function(){})},o.saveCurrentDocument=function(e){var t=e.is_new;if(o.listNumberAlreadyExists)return!1;o.saveCurrent(o.parts.document,e).then(function(e){o.updateStatusBasedOnDocument(),t&&o.goto("/projects/"+o.data.project.id+"/externalaudits/"+o.data.externalaudit.id+"/documents/"+e.id)})},o.newDocument=function(){o.parts.document.state=SavingStateEnum.LoadingNew,r.createNewDocumentEA(o.data.externalaudit)},o.deleteDocument=function(){r.deleteDocumentEA(o.routeParams).then(function(){o.updateStatusBasedOnDocument(),o.goto("/projects/"+o.data.project.id+"/externalaudits/"+o.data.externalaudit.id+"/documents")})},o.uploadAttachment=function(e){e&&(o.showUploadingAttachment=!0,o.attachmentFile=e[0],uploadFile(n,t,i,o.parts.document.form.attachment,o.attachmentFile).then(function(e){o.data.document_ea.file_metadata_id=e.result.id,o.parts.document.form.attachment.$setDirty(),o.saveCurrentDocument(o.data.document_ea)},function(e){}))},o.uploadResponseDocument=function(e){e&&(o.showUploadingResponseDocument=!0,o.responseDocumentFile=e[0],uploadFile(n,t,i,o.parts.document.form.response_document,o.responseDocumentFile).then(function(e){o.data.document_ea.file_metadata_response_id=e.result.id,o.parts.document.form.response_document.$setDirty(),o.saveCurrentDocument(o.data.document_ea)},function(e){}))},o.deleteAttachment=function(){o.showUploadingAttachment=!1,o.data.document_ea.file_metadata_id=null,o.parts.document.form.attachment.$setDirty(),o.saveCurrentDocument(o.data.document_ea)},o.deleteResponseDocument=function(){o.showUploadingResponseDocument=!1,o.data.document_ea.file_metadata_response_id=null,o.parts.document.form.response_document.$setDirty(),o.saveCurrentDocument(o.data.document_ea)},o.calculateNumberOfCopiesOfDocument=function(){o.data.document_ea.director_copy_no=1,o.data.document_ea.coordinator_copy_no=o.data.document_ea.sub_copy_no-1},o.calculateDocumentCode=function(){var e=_.find(o.valuelists.documenttypeexternalaudits,{id:parseInt(o.data.document_ea.type)}),t=o.data.document_ea.id,i=(e?e.description1:"")+(o.data.document_ea.number||"");fetch("/api/v1/document/code-check/"+i).then(function(e){return e.json()}).then(function(e){o.$apply(function(){!e.code_exists||e.code_exists&&t==e.document_id?(o.listNumberAlreadyExists=!1,o.data.document_ea.code=i,o.setDefaultDocumentConclusion()):(o.documentCode=i,o.listNumberAlreadyExists=!0)})})},o.setDefaultDocumentConclusion=function(){0<=_.indexOf(["11"],o.data.document_ea.type)?o.data.document_ea.conclusion=80:o.data.document_ea.conclusion=81},o.isDisabledBasedOnRule=function(e){switch(e){case"document.conclusion":return 81==o.data.document_ea.conclusion&&11!=o.data.document_ea.type;case"document.type":return 12==o.data.document_ea.type;default:return!1}},o.auth.canSave=function(e){if(o.data.document_ea.is_new&&o.parts.document.state==SavingStateEnum.SavingStarted)return!1;switch(e){case"new":case"delete":return o.userinfo.info.role_1;case"can_email":case"document.date_submitted":case"document.sub_copy_no":case"document.title":case"document.type":case"document.number":case"document.code":case"document.consultent":case"document.director_copy_no":case"document.date_sent_director":case"document.coordinator_copy_no":case"document.date_copies_coordinator":case"document.date_next_appointment":case"document.folio_no":case"document.remarks":return o.userinfo.info.role_1;case"document.date_sent_officer":return o.userinfo.info.role_2;case"document.file_metadata_response_id":case"document.conclusion":case"document.date_conclusion":return o.userinfo.info.role_3;case"document.date_sent_from_dep":return o.userinfo.info.role_5;case"move":return o.userinfo.info.role_8;default:return!1}},o.loadDocument=function(){o.parts.document.state=SavingStateEnum.Loading,r.retrieveDocumentEA(o.routeParams)[0].then(function(e){o.parts.document.state=SavingStateEnum.Loaded})},o.parts.document,SavingStateEnum.Loading,r.retrieveProjectData(o.routeParams)[5].then(function(e){r.retrieveExternalAudit(o.routeParams)[1].then(function(e){o.parts.documents.state=SavingStateEnum.Loaded,_.isUndefined(o.routeParams.documentId)||o.loadDocument()})}),o.getEmailerObj=function(e){e=e.email_order&&e.email_order.order_status?e.email_order.order_status:0;return window.emailerStatusObj[e]},o.failedToSendMail=!1,o.createEmailOrder=function(e,t,i,n){o.data.document_ea.email_order={},o.data.document_ea.email_order.order_status=1,window.createEmailOrder(e,t,i,function(e){o.$apply(function(){0==e.order_status?(o.data.document_ea.email_order=null,o.failedToSendMail=!0):o.data.document_ea.email_order=e})})}}]),(controllers=angular.module("seroApp.controllers")).controller("AuditsInspectionsController",["$scope","ProjectFactory","$timeout","Upload","$q",function(i,e,t,n,o){i.parts={auditsinspections:{state:SavingStateEnum.None},auditinspection:{form:null,state:SavingStateEnum.None}},i.newButton={},i.newButton.year=(new Date).getFullYear(),i.fileUploadPattern=fileUploadPattern,i.fileUploadNgfPattern=fileUploadNgfPattern,i.fileUploadMaxSize=fileUploadMaxSize,i.shouldShowAuditInspection=function(e){return i.parts.auditinspection.state!=SavingStateEnum.Loading&&i.routeParams.auditinspectionId==e.id},i.criteriaMatchOfficer1=function(e){return function(e){return!0}},i.criteriaMatchOfficer=function(e){return function(e){return!0}},i.isLoading=function(){return i.parts.auditinspection.state==SavingStateEnum.Loading?!!i.hasAuditInspection():i.parts.auditinspection.state==SavingStateEnum.LoadingNew},i.hasAuditInspection=function(){return!_.isEmpty(i.data.auditinspection)},i.updateStatus=function(e){updateAuditInspectionStatus(e)},i.openAuditInspection=function(e,t){i.routeParams.auditinspectionId==e?i.goto("/projects/"+i.data.project.id+"/auditsinspections"):i.routeParams.auditinspectionId||i.goto("/projects/"+i.data.project.id+"/auditsinspections/"+e)},i.stopPropagation=function(e){e.stopPropagation()},i.saveCurrentAuditInspection=function(){i.data.auditinspection.year=new Date(i.data.auditinspection.date_carried_out).getFullYear();var e=i.data.auditinspection;console.log(e,"about to save");var t=e.is_new;t||i.updateStatus(e),i.saveCurrent(i.parts.auditinspection,e,t).then(function(e){t&&i.goto("/projects/"+i.data.project.id+"/auditsinspections/"+e.id)})},i.newAuditInspection=function(){i.parts.auditinspection.state=SavingStateEnum.LoadingNew,i.newButton.isopen=!1,i.newButton.year=new Date(i.newButton.date_carried_out).getFullYear(),e.createNewAuditInspection(i.data.project,i.newButton.year,i.newButton.type,i.newButton.reason,i.newButton.date_carried_out),i.parts.auditinspection.isNew=!0,i.saveCurrentAuditInspection()},i.deleteAuditInspection=function(){e.deleteAuditInspection(i.routeParams),i.goto("/projects/"+i.data.project.id+"/auditsinspections/")},i.auth.canSave=function(e){return"new"==e?i.userinfo.info.role_7:!!i.userinfo.info.role_8||"lead_officer"!=e&&i.userinfo.info.id===i.data.auditinspection.lead_officer},i.uploadActionTakenLetter=function(e){e&&(i.showUploadingFileActionTakenLetter=!0,i.actionTakenLetterFile=e[0],uploadFile(o,t,n,i.parts.auditinspection.form.action_taken_letter,i.actionTakenLetterFile).then(function(e){i.data.auditinspection.file_metadata_id=e.result.id,i.parts.auditinspection.form.action_taken_letter.$setDirty(),i.saveCurrentAuditInspection(),t(function(){i.showUploadingFileActionTakenLetter=!1},3e3)},function(e){}))},i.uploadReport=function(e){e&&(i.showUploadingFileReport=!0,i.reportFile=e[0],uploadFile(o,t,n,i.parts.auditinspection.form.report,i.reportFile).then(function(e){i.data.auditinspection.file_metadata_report_id=e.result.id,i.parts.auditinspection.form.report.$setDirty(),i.saveCurrentAuditInspection(),t(function(){i.showUploadingFileReport=!1},3e3)},function(e){}))},i.uploadDocumentation=function(e){e&&(i.showUploadingFileDocumentation=!0,i.documentationFile=e[0],uploadFile(o,t,n,i.parts.auditinspection.form.documentation,i.documentationFile).then(function(e){i.data.auditinspection.documentation_ids.push(e.result.id),i.parts.auditinspection.form.documentation.$setDirty(),i.saveCurrentAuditInspection(),t(function(){i.showUploadingFileDocumentation=!1},3e3)},function(e){}))},i.downloadFileUrl=function(e){return"/file/v1/download/"+e},i.deleteActionTakenLetter=function(){i.data.auditinspection.file_metadata_id=null,i.parts.auditinspection.form.action_taken_letter.$setDirty(),i.saveCurrentAuditInspection()},i.deleteReport=function(){i.data.auditinspection.file_metadata_report_id=null,i.parts.auditinspection.form.report.$setDirty(),i.saveCurrentAuditInspection()},i.deleteDocumentation=function(t){_.remove(i.data.auditinspection.documentation_ids,function(e){return e===t}),i.parts.auditinspection.form.documentation.$setDirty(),i.saveCurrentAuditInspection()},i.loadAuditInspection=function(){i.parts.auditinspection.state=SavingStateEnum.Loading,e.retrieveAuditInspection(i.routeParams)[0].then(function(e){i.parts.auditinspection.state=SavingStateEnum.Loaded})},i.parts.auditinspection.state=SavingStateEnum.Loading,e.retrieveProjectData(i.routeParams)[3].then(function(e){i.parts.auditsinspections.state=SavingStateEnum.Loaded,_.isUndefined(i.routeParams.auditinspectionId)||i.loadAuditInspection()})}]),controllers.controller("PermitsLicensesController",["$scope","ProjectFactory","$timeout","Upload","$q","$location",function(o,t,n,r,a,e){o.invalidRecipients=!1,o.parts={permitslicenses:{state:SavingStateEnum.None},permitlicense:{form:null,state:SavingStateEnum.None}},o.newButton={},o.newButton.approved_by_the_lc1=!1,o.newButton.approved_by_the_dec=!1,o.fileUploadPattern=fileUploadPattern,o.fileUploadNgfPattern=fileUploadNgfPattern,o.fileUploadMaxSize=fileUploadMaxSize,o.DocumentTagEnum=DocumentTagEnum,o.documentationData={ApplicationForm:{formField:"documentation_applicationform",tag:DocumentTagEnum.PermitLicenseApplicationForm},PermitLicense:{formField:"documentation_permitlicense",tag:DocumentTagEnum.PermitLicensePermitLicense},Attachments:{formField:"documentation_attachments",tag:DocumentTagEnum.PermitLicenseAttachments}},o.idPermit=118,o.idLicense=119,o.idWetland=123,o.isEcosystemWetland=function(e){return e.ecosystem==o.idWetland},o.shouldShowPermitLicense=function(e){return o.parts.permitlicense.state!=SavingStateEnum.Loading&&o.routeParams.permitlicenseId==e.id},o.notOkToEditOrCreateNew=function(){return!!o.routeParams.permitlicenseId||!!o.data.permitlicense.is_new},o.preventClickIfDisabled=function(e,t){e&&t.preventDefault()},o.openPermitLicense=function(e,t){console.log(o.routeParams.permitlicenseId,e),o.data.permitlicense.is_new||(o.routeParams.permitlicenseId==e?o.goto("/projects/"+o.data.project.id+"/permitslicenses"):(!o.routeParams.permitlicenseId||o.routeParamspermitlicenseId==e)&&o.routeParams.permitlicenseId||o.goto("/projects/"+o.data.project.id+"/permitslicenses/"+e))},o.customValidation=function(e){return e.email_contact&&!window.verifyEmailList(e.email_contact)?!(o.invalidRecipients=!0):!(o.invalidRecipients=!1)},o.saveCurrentPermitLicense=function(e){var t=e.is_new;if(!o.customValidation(e))return!1;o.isEcosystemWetland(e)||(e.regulation_activity=null),o.updateStatus(e),o.saveCurrent(o.parts.permitlicense,e,t).then(function(e){t&&o.goto("/projects/"+o.data.project.id+"/permitslicenses/"+e.id)})},o.updateStatus=function(e){updatePermitLicenseStatus(e)},o.newPermitLicense=function(){o.parts.permitlicense.state=SavingStateEnum.LoadingNew,o.newButton.isopen=!1;var e=null;o.isEcosystemWetland(o.newButton)&&(e=o.newButton.regulation_activity),t.createNewPermitLicense(o.data.project,o.newButton.regulation,o.newButton.ecosystem,e,o.newButton.area,o.newButton.unit,o.newButton.approved_by_the_lc1,o.newButton.approved_by_the_dec,o.newButton.waste_license_type)},o.deletePermitLicense=function(){t.deletePermitLicense(o.routeParams),o.goto("/projects/"+o.data.project.id+"/permitslicenses")},o.calculateDateFeedbackToApplicants=function(){o.data.permitlicense.date_feedback_to_applicants=addDays(o.data.permitlicense.date_submitted,21)},o.uploadDocumentation=function(t,i,e){e&&(i.showUploading=!0,i.file=e[0],uploadFile(a,n,r,o.parts.permitlicense.form[i.formField],i.file,i.tag).then(function(e){t.documentation_ids.push(e.result.id),o.parts.permitlicense.form[i.formField].$setDirty(),o.saveCurrentPermitLicense(t),n(function(){i.showUploading=!1},3e3)},function(e){}))},o.deleteDocumentation=function(e,t,i){_.remove(e.documentation_ids,function(e){return e===t}),o.parts.permitlicense.form[i.formField].$setDirty(),o.saveCurrentPermitLicense(e)},o.hasDocumentationTag=function(e,t){var i=!1;return _.forEach(e,function(e){e.tag==t&&(i=!0)}),i},o.downloadFileUrl=function(e){return"/file/v1/download/"+e},o.auth.canSave=function(e){if(o.data.permitlicense.is_new&&o.parts.permitlicense.state==SavingStateEnum.SavingStarted)return!1;switch(e){case"new":case"delete":case"regulation":case"date_submitted":case"waste_license_type":case"ecosystem":case"regulation_activity":case"area":case"unit":case"approved_by_the_lc1":case"approved_by_the_dec":case"application_number":case"application_fee_receipt_number":case"date_feedback_to_applicants":case"date_sent_to_director":case"date_sent_from_dep":case"folio_no":case"can_email":case"recipient_email":return o.userinfo.info.role_1;case"date_sent_officer":return o.userinfo.info.role_1||o.userinfo.info.role_2;case"personnel":case"remarks_team_leader":return o.userinfo.info.role_2;case"application_evaluation_by_officer":case"date_of_evaluation":case"inspection_recommended":case"date_inspection":case"officer_recommend":case"date_sent_for_decision":return o.userinfo.info.role_3;case"fee_receipt_no":case"date_fee_payed":return o.userinfo.info.role_4;case"user_id":case"decision":case"date_decision":case"signature_on_permit_license":case"date_permit_license":case"permit_license_no":case"date_permit_license_expired":case"upload_documentation_permit_license":case"delete_documentation_permit_license":return o.userinfo.info.role_5;default:return!1}},o.getEmailerObj=function(e){e=e.email_order&&e.email_order.order_status?e.email_order.order_status:0;return window.emailerStatusObj[e]},o.failedToSendMail=!1,o.pl=o.data.permitlicense,o.createEmailOrder=function(e,t,i,n){n.email_order={},n.email_order.order_status=1,window.createEmailOrder(e,t,i,function(e){o.$apply(function(){0==e.order_status?(n.email_order=null,o.failedToSendMail=!0):n.email_order=e})})},o.loadPermitLicense=function(){o.parts.permitlicense.state=SavingStateEnum.Loading,t.retrievePermitLicense(o.routeParams)[0].then(function(e){o.parts.permitlicense.state=SavingStateEnum.Loaded})},o.parts.permitlicense.state=SavingStateEnum.Loading,t.retrieveProjectData(o.routeParams)[4].then(function(e){o.parts.permitslicenses.state=SavingStateEnum.Loaded,_.isUndefined(o.routeParams.permitlicenseId)||o.loadPermitLicense()})}]),controllers.controller("SearchTabsController",["$scope","$routeParams","$location","$q","$timeout","ProjectFactory","Valuelists","UserInfo",function(e,t,i,n,o,r,a,s){e.SearchTabEnum=SearchTabEnum,e.routeParams=t,e.userinfo=s,e.valuelists=a;var c;e.tab=(c=i.path(),_.contains(c,"projects")?SearchTabEnum.Projects:_.contains(c,"eiaspermits")?SearchTabEnum.EiasPermits:_.contains(c,"permitslicenses")?SearchTabEnum.PermitsLicenses:_.contains(c,"auditsinspections")?SearchTabEnum.AuditsInspections:_.contains(c,"externalaudits")?SearchTabEnum.ExternalAudits:null),e.goto=function(e){o(function(){i.path(e)})}}]),controllers.controller("SearchAuditsInspectionsController",["$scope","$routeParams","$location","$q","$timeout","AuditInspectionSearch","UserInfo","Valuelists","SearchService",function(t,e,i,n,o,r,a,s,c){t.isSearching=!1,t.showResultGrid=!1,t.gridOptions={},t.gridOptions.enableHorizontalScrollbar=0,t.gridOptions.showGridFooter=!0,t.gridOptions.minRowsToShow=10,t.gridOptions.enableColumnMenus=!1,t.gridOptions.enableRowSelection=!0,t.gridOptions.enableRowHeaderSelection=!1,t.gridOptions.multiSelect=!1,t.gridOptions.noUnselect=!0,t.gridOptions.enableFooterTotalSelected=!1,t.gridOptions.appScopeProvider={onDblClick:function(e){t.goto("/projects/"+e.project_id+"/auditsinspections/"+e.auditinspection_id)}},t.gridOptions.rowTemplate='<div ng-dblclick="grid.appScope.onDblClick(row.entity)" ng-repeat="(colRenderIndex, col) in colContainer.renderedColumns track by col.colDef.name" class="ui-grid-cell" ng-class="{ \'ui-grid-row-header-cell\': col.isRowHeader }" ui-grid-cell ></div>',t.gridOptions.columnDefs=[{name:"auditinspection_code",displayName:"Number",width:80,cellTooltip:!0,headerTooltip:!0},{name:"project_title",displayName:"Project name",cellTooltip:!0,headerTooltip:!0},{name:"developer_name",displayName:"Developer name",cellTooltip:!0,headerTooltip:!0},{name:"developer_tin",displayName:"TIN",type:"number",width:90,cellTooltip:!0,headerTooltip:!0},{name:"district_district",displayName:"District",cellTooltip:!0,headerTooltip:!0},{name:"auditinspection_type",displayName:"Activity",cellTooltip:!0,headerTooltip:!0},{name:"category_description",displayName:"Category of project",width:150,cellTooltip:!0,headerTooltip:!0},{name:"auditinspection_action_taken",displayName:"Response",cellTooltip:!0,headerTooltip:!0},{name:"auditinspection_performance_level",displayName:"Performance",width:110,cellTooltip:!0,headerTooltip:!0},{name:"auditinspection_date_deadline",displayName:"Deadline for complete compliance",width:90,type:"date",cellFilter:'date:"d MMM yyyy"',headerTooltip:!0}],t.gridOptions.onRegisterApi=function(e){t.gridApi=e},t.setSearchUrl=function(){_.isEmpty(t.criteria)||(_.isEqual(c.criteria,t.criteria)?(c.allowCache=!1,t.search()):i.search(t.criteria))},t.search=function(){t.isSearching=!0,t.showResultGrid=!1,c.search(t.criteria).then(function(e){t.gridOptions.data=e,t.isSearching=!1,t.showResultGrid=!0})},t.reset=function(){t.criteria={},c.criteria={},t.gridOptions.data=[],t.showResultGrid=!1},t.exportAuditAndInspectionResults=function(e){exportObj.exportData(e,"auditAndInspection")},t.criteria=i.search(),_.isEmpty(t.criteria)&&!_.isEmpty(c.criteria)?i.search(c.criteria):_.isEmpty(t.criteria)||t.search()}]),controllers.controller("SearchProjectsController",["$scope","$routeParams","$location","$q","$timeout","ProjectSearch","UserInfo","Valuelists","ProjectSearchService",function(t,e,i,n,o,r,a,s,c){t.isSearching=!1,t.showResultGrid=!1,t.gridOptions={},t.gridOptions.enableHorizontalScrollbar=0,t.gridOptions.showGridFooter=!0,t.gridOptions.minRowsToShow=10,t.gridOptions.enableColumnMenus=!1,t.gridOptions.enableRowSelection=!0,t.gridOptions.enableRowHeaderSelection=!1,t.gridOptions.multiSelect=!1,t.gridOptions.noUnselect=!0,t.gridOptions.enableFooterTotalSelected=!1,t.gridOptions.appScopeProvider={onDblClick:function(e){t.goto("/projects/"+e.project_id)}},t.gridOptions.rowTemplate='<div ng-dblclick="grid.appScope.onDblClick(row.entity)" ng-repeat="(colRenderIndex, col) in colContainer.renderedColumns track by col.colDef.name" class="ui-grid-cell" ng-class="{ \'ui-grid-row-header-cell\': col.isRowHeader }" ui-grid-cell ></div>',t.gridOptions.columnDefs=[{name:"project_id",displayName:"Id",type:"number",width:50,cellTooltip:!0,headerTooltip:!0},{name:"project_title",displayName:"Name",cellTooltip:!0,headerTooltip:!0},{name:"project_location",displayName:"Location",cellTooltip:!0,headerTooltip:!0},{name:"district_district",displayName:"District",cellTooltip:!0,headerTooltip:!0},{name:"category_description",displayName:"Category",cellTooltip:!0,headerTooltip:!0},{name:"developer_name",displayName:"Developer name",cellTooltip:!0,headerTooltip:!0},{name:"developer_tin",displayName:"TIN",type:"number",width:90,cellTooltip:!0,headerTooltip:!0}],t.gridOptions.onRegisterApi=function(e){t.gridApi=e},t.setSearchUrl=function(){_.isEmpty(t.criteria)||(_.isEqual(c.criteria,t.criteria)?(c.allowCache=!1,t.search()):i.search(t.criteria))},t.search=function(){t.isSearching=!0,t.showResultGrid=!1,c.search(t.criteria).then(function(e){t.gridOptions.data=e,localStorage.projectData=JSON.stringify(e),t.isSearching=!1,t.showResultGrid=!0})},t.reset=function(){t.criteria={},c.criteria={},t.gridOptions.data=[],t.showResultGrid=!1},t.criteria=i.search(),_.isEmpty(t.criteria)&&!_.isEmpty(c.criteria)?i.search(c.criteria):_.isEmpty(t.criteria)||t.search(),t.exportProjects=function(e){exportObj.exportData(e,"project")}}]),controllers.controller("SearchEiasPermitsController",["$scope","$routeParams","$location","$q","$timeout","EiaPermitSearch","UserInfo","Valuelists","EiaPermitSearchService",function(i,e,t,n,o,r,a,s,c){i.isSearching=!1,i.showResultGrid=!1,i.gridOptions={},i.gridOptions.enableHorizontalScrollbar=0,i.gridOptions.showGridFooter=!0,i.gridOptions.minRowsToShow=10,i.gridOptions.enableColumnMenus=!1,i.gridOptions.enableRowSelection=!0,i.gridOptions.enableRowHeaderSelection=!1,i.gridOptions.multiSelect=!1,i.gridOptions.noUnselect=!0,i.gridOptions.enableFooterTotalSelected=!1,i.gridOptions.appScopeProvider={onDblClick:function(e){i.goto("/projects/"+e.project_id+"/eiaspermits/"+e.eiapermit_id)}},i.gridOptions.rowTemplate='<div ng-dblclick="grid.appScope.onDblClick(row.entity)" ng-repeat="(colRenderIndex, col) in colContainer.renderedColumns track by col.colDef.name" class="ui-grid-cell" ng-class="{ \'ui-grid-row-header-cell\': col.isRowHeader }" ui-grid-cell ></div>',i.gridOptions.columnDefs=[{name:"eiapermit_id",displayName:"EIA Id",type:"number",width:80,cellTooltip:!0,headerTooltip:!0},{name:"eiapermit_status",displayName:"Status",cellTooltip:!0,headerTooltip:!0},{name:"eiapermit_decision",displayName:"Decision taken",cellTooltip:!0,headerTooltip:!0},{name:"eiapermit_officer_assigned",displayName:"Team leader",cellTooltip:!0,headerTooltip:!0},{name:"project_title",displayName:"Project name",cellTooltip:!0,headerTooltip:!0},{name:"eiapermit_certificate_no",displayName:"Certificate No.",cellTooltip:!0,headerTooltip:!0}],i.gridOptions.onRegisterApi=function(e){i.gridApi=e},i.setSearchUrl=function(){_.forOwn(i.dateCriteria,function(e,t){e instanceof Date&&(e.setHours(12),i.criteria[t]=e.toJSON().substr(0,10))}),_.isEmpty(i.criteria)||(_.isEqual(c.criteria,i.criteria)?(c.allowCache=!1,i.search()):t.search(i.criteria))},i.search=function(){i.isSearching=!0,i.showResultGrid=!1,c.search(i.criteria).then(function(e){i.gridOptions.data=e,i.isSearching=!1,i.showResultGrid=!0})},i.reset=function(){i.criteria={},i.dateCriteria={},c.criteria={},i.gridOptions.data=[],i.showResultGrid=!1},i.exportEiasPermits=function(e){exportObj.exportData(e,"eiaspermits")},i.criteria=t.search(),i.dateCriteria={},i.criteria.eiapermit_date_submission_from&&(i.dateCriteria.eiapermit_date_submission_from=new Date(i.criteria.eiapermit_date_submission_from)),i.criteria.eiapermit_date_submission_to&&(i.dateCriteria.eiapermit_date_submission_to=new Date(i.criteria.eiapermit_date_submission_to)),_.isEmpty(i.criteria)&&!_.isEmpty(c.criteria)?t.search(c.criteria):_.isEmpty(i.criteria)||i.search()}]),controllers.controller("SearchPermitsLicensesController",["$scope","$routeParams","$location","$q","$timeout","PermitLicenseSearch","UserInfo","Valuelists","PermitLicenseSearchService",function(i,e,t,n,o,r,a,s,c){i.isSearching=!1,i.showResultGrid=!1,i.gridOptions={},i.gridOptions.enableHorizontalScrollbar=0,i.gridOptions.showGridFooter=!0,i.gridOptions.minRowsToShow=10,i.gridOptions.enableColumnMenus=!1,i.gridOptions.enableRowSelection=!0,i.gridOptions.enableRowHeaderSelection=!1,i.gridOptions.multiSelect=!1,i.gridOptions.noUnselect=!0,i.gridOptions.enableFooterTotalSelected=!1,i.gridOptions.appScopeProvider={onDblClick:function(e){i.goto("/projects/"+e.project_id+"/permitslicenses/"+e.permitlicense_id)}},i.gridOptions.rowTemplate='<div ng-dblclick="grid.appScope.onDblClick(row.entity)" ng-repeat="(colRenderIndex, col) in colContainer.renderedColumns track by col.colDef.name" class="ui-grid-cell" ng-class="{ \'ui-grid-row-header-cell\': col.isRowHeader }" ui-grid-cell ></div>',i.gridOptions.columnDefs=[{name:"permitlicense_id",displayName:"PL Id",type:"number",width:80,cellTooltip:!0,headerTooltip:!0},{name:"permitlicense_date_submitted",displayName:"Date of submission",width:130,type:"date",cellFilter:'date:"d MMM yyyy"',headerTooltip:!0},{name:"permitlicense_regulation",displayName:"Regulation",width:80,cellTooltip:!0,headerTooltip:!0},{name:"permitlicense_officer_assigned",displayName:"Team leader",cellTooltip:!0,headerTooltip:!0},{name:"project_title",displayName:"Project name",cellTooltip:!0,headerTooltip:!0}],i.idPermit=118,i.idLicense=119,i.idWetland=123,i.idRB=124,i.idLS=125,i.isDisabled=function(e){switch(e){case"permitlicense_ecosystem":return i.criteria.permitlicense_regulation==i.idLicense;case"permitlicense_waste_license_type":return i.criteria.permitlicense_regulation==i.idPermit;case"permitlicense_regulation_activity":return i.criteria.permitlicense_regulation==i.idLicense||i.criteria.permitlicense_ecosystem==i.idRB||i.criteria.permitlicense_ecosystem==i.idLS;default:return!1}},i.gridOptions.onRegisterApi=function(e){i.gridApi=e},i.setSearchUrl=function(){i.removeDisabledSearchCriteria(),_.forOwn(i.dateCriteria,function(e,t){e instanceof Date&&(e.setHours(12),i.criteria[t]=e.toJSON().substr(0,10))}),_.isEmpty(i.criteria)||(_.isEqual(c.criteria,i.criteria)?(c.allowCache=!1,i.search()):t.search(i.criteria))},i.removeDisabledSearchCriteria=function(){_.forOwn(i.criteria,function(e,t){i.isDisabled(t)&&(i.criteria[t]=null)})},i.search=function(){i.isSearching=!0,i.showResultGrid=!1,c.search(i.criteria).then(function(e){i.gridOptions.data=e,i.isSearching=!1,i.showResultGrid=!0})},i.reset=function(){i.criteria={},i.dateCriteria={},c.criteria={},i.gridOptions.data=[],i.showResultGrid=!1},i.exportPermitsLicensesResults=function(e){exportObj.exportData(e,"exportPermitsLicenses")},i.criteria=t.search(),i.dateCriteria={},i.criteria.permitlicense_date_submission_from&&(i.dateCriteria.permitlicense_date_submission_from=new Date(i.criteria.permitlicense_date_submission_from)),i.criteria.permitlicense_date_submission_to&&(i.dateCriteria.permitlicense_date_submission_to=new Date(i.criteria.permitlicense_date_submission_to)),_.isEmpty(i.criteria)&&!_.isEmpty(c.criteria)?t.search(c.criteria):_.isEmpty(i.criteria)||i.search()}]),controllers.controller("StatisticsTabsController",["$scope","$routeParams","$location","$q","$timeout","ProjectFactory","Valuelists","StatisticsService",function(e,t,i,n,o,r,a,s){e.routeParams=t,e.valuelists=a,e.StatisticsService=s,e.StatisticsTabEnum=StatisticsTabEnum;var c;e.tab=(c=i.path(),_.contains(c,"projects")?StatisticsTabEnum.Projects:_.contains(c,"eiaspermits")?StatisticsTabEnum.EiasPermits:_.contains(c,"auditsinspections")?StatisticsTabEnum.AuditsInspections:null),e.goto=function(e){o(function(){i.path(e)})}}]),controllers.controller("StatisticsProjectsController",["$scope","$routeParams","$location","$q","$timeout","ProjectStatistics","UserInfo","Valuelists","StatisticsService",function(t,e,i,n,o,r,a,s,c){t.data={},t.isLoadingData=!0,c.getProjectData().then(function(e){t.data=e,t.isLoadingData=!1})}]),controllers.controller("SearchExternalAuditsController",["$scope","$routeParams","$location","$q","$timeout","ExternalAuditSearch","UserInfo","Valuelists","ExternalAuditSearchService",function(i,e,t,n,o,r,a,s,c){i.isSearching=!1,i.showResultGrid=!1,i.gridOptions={},i.gridOptions.enableHorizontalScrollbar=0,i.gridOptions.showGridFooter=!0,i.gridOptions.minRowsToShow=10,i.gridOptions.enableColumnMenus=!1,i.gridOptions.enableRowSelection=!0,i.gridOptions.enableRowHeaderSelection=!1,i.gridOptions.multiSelect=!1,i.gridOptions.noUnselect=!0,i.gridOptions.enableFooterTotalSelected=!1,i.gridOptions.appScopeProvider={onDblClick:function(e){i.goto("/projects/"+e.project_id+"/externalaudits/"+e.externalaudit_id)}},i.gridOptions.rowTemplate='<div ng-dblclick="grid.appScope.onDblClick(row.entity)" ng-repeat="(colRenderIndex, col) in colContainer.renderedColumns track by col.colDef.name" class="ui-grid-cell" ng-class="{ \'ui-grid-row-header-cell\': col.isRowHeader }" ui-grid-cell ></div>',i.gridOptions.columnDefs=[{name:"externalaudit_id",displayName:"EA Id",type:"number",width:80,cellTooltip:!0,headerTooltip:!0},{name:"externalaudit_status",displayName:"Status",width:200,cellTooltip:!0,headerTooltip:!0},{name:"externalaudit_officer_assigned",displayName:"Team leader",cellTooltip:!0,headerTooltip:!0},{name:"project_title",displayName:"Project name",cellTooltip:!0,headerTooltip:!0},{name:"verification_inspection",displayName:"Verification inspection",width:162,cellTooltip:!0,headerTooltip:!0},{name:"response",displayName:"Response",width:80,cellTooltip:!0,headerTooltip:!0}],i.gridOptions.onRegisterApi=function(e){i.gridApi=e},i.setSearchUrl=function(){_.forOwn(i.dateCriteria,function(e,t){e instanceof Date&&(e.setHours(12),i.criteria[t]=e.toJSON().substr(0,10))}),_.isEmpty(i.criteria)||(_.isEqual(c.criteria,i.criteria)?(c.allowCache=!1,i.search()):t.search(i.criteria))},i.search=function(){i.isSearching=!0,i.showResultGrid=!1,c.search(i.criteria).then(function(e){i.gridOptions.data=e,i.isSearching=!1,i.showResultGrid=!0})},i.exportExternalAuditResults=function(e){exportObj.exportData(e,"externalAudit")},i.reset=function(){i.criteria={},i.dateCriteria={},c.criteria={},i.gridOptions.data=[],i.showResultGrid=!1},i.criteria=t.search(),i.dateCriteria={},i.criteria.externalaudit_date_submission_from&&(i.dateCriteria.externalaudit_date_submission_from=new Date(i.criteria.externalaudit_date_submission_from)),i.criteria.externalaudit_date_submission_to&&(i.dateCriteria.externalaudit_date_submission_to=new Date(i.criteria.externalaudit_date_submission_to)),_.isEmpty(i.criteria)&&!_.isEmpty(c.criteria)?t.search(c.criteria):_.isEmpty(i.criteria)||i.search()}]),controllers.controller("AdvancedCodesController",["$scope","$routeParams","EditCode","$timeout","$q","$interval","uiGridConstants",function(i,e,t,n,o,r,a){i.routeParams=e,i.parts={code:{form:null,state:SavingStateEnum.Loading}},i.gridOptions={},i.gridOptions.enableCellEditOnFocus=!0,i.gridOptions.showGridFooter=!0,i.gridOptions.minRowsToShow=15,i.gridOptions.rowEditWaitInterval=1e3,i.gridOptions.enableFiltering=!0,i.gridOptions.columnDefs=[{name:"id",type:"number",enableCellEdit:!1,width:60},{name:"description1",cellTooltip:!0,width:"*"},{name:"description2",cellTooltip:!0,width:150},{name:"value1",type:"number",width:100},{name:"dropdown_list",cellTooltip:!0,width:150},{name:"updated_by",enableCellEdit:!1,width:120},{name:"updated_at",enableCellEdit:!1,enableFiltering:!1,type:"date",cellFilter:'date:"d MMM yyyy HH:mm:ss"',width:160},{name:"delete",displayName:"",enableSorting:!1,enableCellEdit:!1,enableFiltering:!1,enableColumnMenu:!1,width:80,cellTemplate:'<div><button ng-show="row.entity.deleted_at" ng-click="grid.appScope.undeleteRow(row.entity)" class="btn undelete btn-sm btn-link">undelete</button><button ng-hide="row.entity.deleted_at" ng-click="grid.appScope.deleteRow(row.entity)" class="btn delete btn-sm btn-link">delete</button></div>'}],i.saveRow=function(e){var t=e.$update();i.gridApi.rowEdit.setSavePromise(e,t)},i.deleteRow=function(e){var t=e.$delete({});i.gridApi.rowEdit.setSavePromise(e,t)},i.undeleteRow=function(e){e.deleted_at=null,i.saveRow(e)},i.addRow=function(){(new t).$save().then(function(e){i.gridOptions.data.push(e),n(function(){i.gridApi.cellNav.scrollToFocus(e,i.gridOptions.columnDefs[0])})})},i.gridOptions.onRegisterApi=function(e){(i.gridApi=e).rowEdit.on.saveRow(i,i.saveRow)},t.query({},function(e){i.gridOptions.data=e})}]),controllers.controller("AdvancedUsersController",["$scope","$routeParams","EditUser","$timeout","$q","$interval","uiGridConstants",function(i,e,t,n,o,r,a){i.routeParams=e,i.parts={code:{form:null,state:SavingStateEnum.Loading}},i.gridOptions={},i.gridOptions.enableCellEditOnFocus=!0,i.gridOptions.showGridFooter=!0,i.gridOptions.minRowsToShow=15,i.gridOptions.rowEditWaitInterval=1e3,i.gridOptions.enableFiltering=!0,i.gridOptions.columnDefs=[{name:"id",type:"number",enableCellEdit:!1,width:60},{name:"initials",cellTooltip:!0,width:80},{name:"name",cellTooltip:!0,width:"*"},{name:"job_position_code",cellTooltip:!0,width:80},{name:"job_position_name",cellTooltip:!0,width:100},{name:"email",cellTooltip:!0,width:100},{name:"password",cellTooltip:!0,width:80},{name:"is_passive",type:"number",width:90},{name:"role_ids",enableCellEdit:!0,width:90},{name:"updated_by",enableCellEdit:!1,width:120},{name:"updated_at",enableCellEdit:!1,enableFiltering:!1,type:"date",cellFilter:'date:"d MMM yyyy HH:mm:ss"',width:160},{name:"delete",displayName:"",enableSorting:!1,enableCellEdit:!1,enableFiltering:!1,enableColumnMenu:!1,width:80,cellTemplate:'<div><button ng-show="row.entity.deleted_at" ng-click="grid.appScope.undeleteRow(row.entity)" class="btn undelete btn-sm btn-link">undelete</button><button ng-hide="row.entity.deleted_at" ng-click="grid.appScope.deleteRow(row.entity)" class="btn delete btn-sm btn-link">delete</button></div>'}],i.saveRow=function(e){var t=e.$update();i.gridApi.rowEdit.setSavePromise(e,t)},i.deleteRow=function(e){var t=e.$delete({});i.gridApi.rowEdit.setSavePromise(e,t)},i.undeleteRow=function(e){e.deleted_at=null,i.saveRow(e)},i.addRow=function(){(new t).$save().then(function(e){i.gridOptions.data.push(e),n(function(){i.gridApi.cellNav.scrollToFocus(e,i.gridOptions.columnDefs[0])})})},i.gridOptions.onRegisterApi=function(e){(i.gridApi=e).rowEdit.on.saveRow(i,i.saveRow)},t.query({},function(e){i.gridOptions.data=e})}]),controllers.controller("AdvancedLeadAgenciesController",["$scope","$routeParams","EditLeadAgency","$timeout","$q","$interval","uiGridConstants",function(i,e,t,n,o,r,a){i.routeParams=e,i.parts={code:{form:null,state:SavingStateEnum.Loading}},i.gridOptions={},i.gridOptions.enableCellEditOnFocus=!0,i.gridOptions.showGridFooter=!0,i.gridOptions.minRowsToShow=15,i.gridOptions.rowEditWaitInterval=1e3,i.gridOptions.enableFiltering=!0,i.gridOptions.columnDefs=[{name:"id",type:"number",enableCellEdit:!1,width:60},{name:"short_name",cellTooltip:!0,width:150},{name:"long_name",cellTooltip:!0,width:"*"},{name:"updated_by",enableCellEdit:!1,width:120},{name:"updated_at",enableCellEdit:!1,enableFiltering:!1,type:"date",cellFilter:'date:"d MMM yyyy HH:mm:ss"',width:160},{name:"delete",displayName:"",enableSorting:!1,enableCellEdit:!1,enableFiltering:!1,enableColumnMenu:!1,width:80,cellTemplate:'<div><button ng-show="row.entity.deleted_at" ng-click="grid.appScope.undeleteRow(row.entity)" class="btn undelete btn-sm btn-link">undelete</button><button ng-hide="row.entity.deleted_at" ng-click="grid.appScope.deleteRow(row.entity)" class="btn delete btn-sm btn-link">delete</button></div>'}],i.saveRow=function(e){var t=e.$update();i.gridApi.rowEdit.setSavePromise(e,t)},i.deleteRow=function(e){var t=e.$delete({});i.gridApi.rowEdit.setSavePromise(e,t)},i.undeleteRow=function(e){e.deleted_at=null,i.saveRow(e)},i.addRow=function(){(new t).$save().then(function(e){i.gridOptions.data.push(e),n(function(){i.gridApi.cellNav.scrollToFocus(e,i.gridOptions.columnDefs[0])})})},i.gridOptions.onRegisterApi=function(e){(i.gridApi=e).rowEdit.on.saveRow(i,i.saveRow)},t.query({},function(e){i.gridOptions.data=e})}]),controllers.controller("AdvancedEmailOrderController",["$scope","$routeParams","EditEmailOrder","$timeout","$q","$interval","uiGridConstants",function(i,e,t,n,o,r,a){i.routeParams=e,i.parts={code:{form:null,state:SavingStateEnum.Loading}},i.gridOptions={},i.gridOptions.enableCellEditOnFocus=!0,i.gridOptions.showGridFooter=!0,i.gridOptions.minRowsToShow=15,i.gridOptions.rowEditWaitInterval=1e3,i.gridOptions.enableFiltering=!0,i.gridOptions.columnDefs=[{name:"id",type:"number",enableCellEdit:!1,width:60},{name:"foreign_id",enableCellEdit:!1,width:80,cellTemplate:'<a href="/resolveLink/emailOrder/{{row.entity.foreign_type}}/{{row.entity.foreign_id}}" ng-click="grid.appScope.visitLink(row.entity)">{{row.entity.foreign_id}}</a>'},{name:"foreign_type",enableCellEdit:!1,width:80},{name:"order_status",enableCellEdit:!0,width:80},{name:"subject",enableCellEdit:!1,width:120},{name:"body",enableCellEdit:!1,width:160},{name:"recipient",enableCellEdit:!0,width:160},{name:"cc",enableCellEdit:!1,width:120},{name:"bcc",enableCellEdit:!1,width:120},{name:"remarks_from_service",enableCellEdit:!1,width:200},{name:"remarks",enableCellEdit:!0,width:120},{name:"updated_by",enableCellEdit:!1,width:120},{name:"updated_at",enableCellEdit:!1,enableFiltering:!1,type:"date",cellFilter:'date:"d MMM yyyy HH:mm:ss"',width:160},{name:"created_by",enableCellEdit:!1,enableFiltering:!1,type:"date",cellFilter:'date:"d MMM yyyy HH:mm:ss"',width:160},{name:"delete",displayName:"",enableSorting:!1,enableCellEdit:!1,enableFiltering:!1,enableColumnMenu:!1,width:80,cellTemplate:'<div><button ng-show="row.entity.deleted_at" ng-click="grid.appScope.undeleteRow(row.entity)" class="btn undelete btn-sm btn-link">undelete</button><button ng-hide="row.entity.deleted_at" ng-click="grid.appScope.deleteRow(row.entity)" class="btn delete btn-sm btn-link">delete</button></div>'}],i.exportEmailOrders=function(e){exportObj.exportData(e,"emailOrders")},i.saveRow=function(e){var t=e.$update();i.gridApi.rowEdit.setSavePromise(e,t)},i.deleteRow=function(e){var t=e.$delete({});i.gridApi.rowEdit.setSavePromise(e,t)},i.undeleteRow=function(e){e.deleted_at=null,i.saveRow(e)},i.gridOptions.onRegisterApi=function(e){(i.gridApi=e).rowEdit.on.saveRow(i,i.saveRow)},t.query({},function(e){i.gridOptions.data=e})}]),controllers.controller("LoginController",["$scope","$http","$routeParams","$location","UserInfo","$timeout",function(o,e,t,r,a,i){o.loginData={},o.sendData={},o.resetData={},o.loginMessages=[],o.sendMessages=[],o.resetMessages=[],o.loginFormDisabled=!1,o.sendFormDisabled=!1,o.resetFormDisabled=!1,o.forgot=function(){console.debug("/password/email")};function s(e){return _.flatten(_.values(e))}o.login=function(){o.loginForm.$invalid||(o.loginFormDisabled=!0,e.post("/auth/login",o.loginData).success(function(e,t,i,n){o.loginMessages=s(e),a.reTry(),r.path("/")}).error(function(e,t,i,n){o.loginMessages=s(e),o.loginFormDisabled=!1}))},o.send=function(){o.sendForm.$invalid||(o.sendFormDisabled=!0,e.post("/password/email",o.sendData).success(function(e,t,i,n){o.sendMessages=s(e)}).error(function(e,t,i,n){o.sendMessages=s(e),o.sendFormDisabled=!1}))},o.reset=function(){o.resetForm.$invalid||(o.resetFormDisabled=!0,o.resetData.token=t.token,e.post("/password/reset",o.resetData).success(function(e,t,i,n){o.resetMessages=s(e),a.reTry(),r.path("/user")}).error(function(e,t,i,n){o.resetMessages=s(e),o.resetFormDisabled=!1}))},i(function(){})}]),(controllers=angular.module("seroApp.controllers")).controller("EiapermitPirkingController",["$scope","$http","EiaPermit","Document","Valuelists","$q",function(r,e,a,s,c,d){r.lastId="..",r.criteria={},r.dryrun=!0,r.eiaspermits=[],r.working=!1,r.info={error:0,nochange:0,changed:0,finished:function(){return this.error+this.nochange+this.changed},progress:function(){return 0==r.eiaspermits.length?0:Math.round(100*this.finished()/r.eiaspermits.length)}},e({method:"GET",url:"/pirking/v1/eiaspermits/stats"}).then(function(e){r.lastId=e.data},function(e){console.log("couldn't fetch stats")}),r.beginPirking=function(){r.info.error=0,r.info.nochange=0,r.info.changed=0,console.log("beginPirking"),console.log("dryrun:",r.dryrun),r.working=!0,e({method:"GET",url:"/pirking/v1/eiaspermits",params:r.criteria}).then(function(e){r.eiaspermits=e.data,console.log("beginPirking finished"),r.beginUpdate()},function(e){console.log("oh noes")})};r.beginUpdate=function(){function i(i){i.updating=!0;var n={projectId:i.project_id,eiapermitId:i.eiapermit_id},e=a.get(n).$promise,t=s.query(n).$promise,o=d.defer();return d.all([e,t]).then(function(e){var t=e[0],e=updateEiaPermitStatus(t,e[1]);i.status_id_new=t.status,i.status_description_new=function(e){e=_.find(c.eiastatus,{id:e});return e?e.description1:""}(t.status),e?r.dryrun?(i.changed=!0,i.result="CHANGED",r.info.changed+=1,i.updating=!1,o.resolve()):(t.pirking=!0,t.$update(n,function(e){i.changed=!0,i.result="CHANGED",r.info.changed+=1,i.updating=!1,i.eiapermit_updated_at=e.updated_at,o.resolve()})):(i.nochange=!0,i.result="NO CHANGE",r.info.nochange+=1,i.updating=!1,o.resolve())},function(e){i.updating=!1,i.error=!0,i.result="ERROR",r.info.error+=1,o.reject("Server Error")}),o.promise}console.log("beginUpdate"),r.eiaspermits.reduce(function(e,t){return e.then(function(){return i(t)}).catch(function(e){console.log("ERROR:",e)})},d.when()).then(function(){console.log("beginUpdate finished"),r.working=!1})}}]),controllers.controller("ExternalAudiPirkingController",["$scope","$http","ProjectFactory","Document","Valuelists","$q",function(r,e,t,i,a,s){r.lastId="sdjshdfj..",r.criteria={},r.dryrun=!0,r.EaData=[],r.working=!1,r.info={error:0,nochange:0,changed:0,finished:function(){return this.error+this.nochange+this.changed},progress:function(){return 0==r.EaData.length?0:Math.round(100*this.finished()/r.EaData.length)}},e({method:"GET",url:"/pirking/v1/externalAuditList/stats"}).then(function(e){r.lastId=e.data},function(e){console.log("couldn't fetch stats")}),r.beginPirking=function(){r.info.error=0,r.info.nochange=0,r.info.changed=0,console.log("beginPirking"),console.log("dryrun:",r.dryrun),r.working=!0,e({method:"GET",url:"/pirking/v1/externalAuditList",params:r.criteria}).then(function(e){r.EaData=e.data,console.log("beginPirking finished"),r.beginUpdate()},function(e){console.log("oh noes")})};r.beginUpdate=function(){function i(i){i.updating=!0;var n={projectId:i.project_id,externalauditId:i.externalaudit_id},e=t.retrieveProjectData(n),o=s.defer();return s.all([e[5]]).then(function(e){var t=_.find(e[0],{id:i.externalaudit_id});console.log(t,"data");e=updateExternalAuditStatus(t,t.documents);i.status_id_new=t.status,i.status_description_new=function(e){e=_.find(a.eastatus,{id:e});return e?e.description1:""}(t.status),e&&parseInt(i.status_id_new)!=parseInt(i.status_id)?r.dryrun?(i.changed=!0,i.result="CHANGED",r.info.changed+=1,i.updating=!1,o.resolve()):(t.pirking=!0,t.$update(n,function(e){i.changed=!0,i.result="CHANGED",r.info.changed+=1,i.updating=!1,i.externalaudit_updated_at=e.updated_at,o.resolve()})):(i.nochange=!0,i.result="NO CHANGE",r.info.nochange+=1,i.updating=!1,o.resolve())},function(e){i.updating=!1,i.error=!0,i.result="ERROR",r.info.error+=1,o.reject("Server Error")}),o.promise}console.log("beginUpdate"),r.EaData.reduce(function(e,t){return e.then(function(){var e=i(t);return console.log(e,"ray"),e}).catch(function(e){console.log("ERROR:",e)})},s.when()).then(function(){console.log("beginUpdate finished"),r.working=!1})}}]),controllers.controller("AuditInspecitionPirkingController",["$scope","$http","ProjectFactory","Valuelists","$q",function(r,e,t,a,s){r.lastId="..",r.criteria={},r.dryrun=!0,r.aiData=[],r.working=!1,r.info={error:0,nochange:0,changed:0,finished:function(){return this.error+this.nochange+this.changed},progress:function(){return 0==r.aiData.length?0:Math.round(100*this.finished()/r.aiData.length)}},e({method:"GET",url:"/pirking/v1/auditInspection/stats"}).then(function(e){r.lastId=e.data},function(e){console.log("couldn't fetch stats")}),r.beginPirking=function(){r.info.error=0,r.info.nochange=0,r.info.changed=0,console.log("beginPirking"),console.log("dryrun:",r.dryrun),r.working=!0,e({method:"GET",url:"/pirking/v1/auditInspection",params:r.criteria}).then(function(e){r.aiData=e.data,console.log("beginPirking finished"),r.beginUpdate()},function(e){console.log("oh noes")})};r.beginUpdate=function(){function i(i){i.updating=!0;var n={projectId:i.project_id,auditinspectionId:i.auditsInspections_id},e=t.retrieveProjectData(n),o=s.defer();return s.all([e[3]]).then(function(e){var t=_.find(e[0],{id:i.auditsInspections_id}),e=updateAuditInspectionStatus(t);i.status_id_new=t.status,i.status_description_new=function(e){e=_.find(a.auditinspectionstatus,{id:e});return e?e.description1:""}(t.status),e&&parseInt(i.status_id_new)!=parseInt(i.status_id)?r.dryrun?(i.changed=!0,i.result="CHANGED",r.info.changed+=1,i.updating=!1,o.resolve()):(t.pirking=!0,t.$update(n,function(e){i.changed=!0,i.result="CHANGED",r.info.changed+=1,i.updating=!1,i.externalaudit_updated_at=e.updated_at,o.resolve()})):(i.nochange=!0,i.result="NO CHANGE",r.info.nochange+=1,i.updating=!1,o.resolve())},function(e){i.updating=!1,i.error=!0,i.result="ERROR",r.info.error+=1,o.reject("Server Error")}),o.promise}console.log("beginUpdate"),r.aiData.reduce(function(e,t){return e.then(function(){return i(t)}).catch(function(e){console.log("ERROR:",e)})},s.when()).then(function(){console.log("beginUpdate finished"),r.working=!1})}}]),controllers.controller("PermitLicensePirkingController",["$scope","$http","ProjectFactory","Valuelists","$q",function(r,e,t,a,s){r.lastId="..",r.criteria={},r.dryrun=!0,r.plData=[],r.working=!1,r.info={error:0,nochange:0,changed:0,finished:function(){return this.error+this.nochange+this.changed},progress:function(){return 0==r.plData.length?0:Math.round(100*this.finished()/r.plData.length)}},e({method:"GET",url:"/pirking/v1/permitLicense/stats"}).then(function(e){r.lastId=e.data},function(e){console.log("couldn't fetch stats")}),r.beginPirking=function(){r.info.error=0,r.info.nochange=0,r.info.changed=0,console.log("beginPirking"),console.log("dryrun:",r.dryrun),r.working=!0,e({method:"GET",url:"/pirking/v1/permitLicense",params:r.criteria}).then(function(e){r.plData=e.data,console.log("beginPirking finished"),r.beginUpdate()},function(e){console.log("oh noes")})};r.beginUpdate=function(){function i(i){var n={projectId:i.project_id,permitlicenseId:i.permitLicense_id},e=t.retrieveProjectData(n),o=s.defer();return s.all([e[4]]).then(function(e){var t=_.find(e[0],{id:i.permitLicense_id});t&&(console.log("before the change",t),e=updatePermitLicenseStatus(t),i.status_id_new=t.status,i.status_description_new=function(e){e=_.find(a.permitlicencestatus,{id:e});return e?e.description1:""}(t.status),e&&parseInt(i.status_id_new)!=parseInt(i.status_id)?r.dryrun?(i.changed=!0,i.result="CHANGED",r.info.changed+=1,i.updating=!1,o.resolve()):(t.pirking=!0,t.$update(n,function(e){i.changed=!0,i.result="CHANGED",r.info.changed+=1,i.updating=!1,i.externalaudit_updated_at=e.updated_at,o.resolve()})):(i.nochange=!0,i.result="NO CHANGE",r.info.nochange+=1,i.updating=!1,o.resolve()))},function(e){i.updating=!1,i.error=!0,i.result="ERROR",r.info.error+=1,o.reject("Server Error")}),o.promise}console.log("beginUpdate"),r.plData.reduce(function(e,t){return e.then(function(){return i(t)}).catch(function(e){console.log("ERROR:",e)})},s.when()).then(function(){console.log("beginUpdate finished"),r.working=!1})}}]),(controllers=angular.module("seroApp.controllers")).controller("DataAnonymizerController",["$scope","$http",function(t,i){t.defaultBtnTxt="anonymize",t.loaded=!0,t.successState=parseInt(localStorage.reloaded_dac),localStorage.reloaded_dac=0,t.working=!1,console.log(t.successState,t.working,"params"),t.done=0,t.anonymize=function(e){t.working=!0,i({method:"GET",url:"/anonymizerData/v1/"+e,params:t.criteria}).then(function(e){t.working=!1,t.successState=e.data.status,t.done=2,t.successState&&(localStorage.reloaded_dac=t.successState,window.location.reload())},function(e){t.done=2,t.working=!1,t.successState=0})}}]);var directives=angular.module("seroApp.directives").directive("appVersion",["version",function(n){return function(e,t,i){t.text(n.replace(/\.0$/,"").replace(/\.00$/,".0").replace(/\.([1-9])$/,".0$1"))}}]);directives.directive("addPractitionerButton",["Practitioner",function(n){return{restrict:"A",link:function(e,t,i){t.bind("click",function(){new n({person:"Gunnar Nymann",city:"Oslo"}).$save()})}}}]),directives.directive("animateNewElement",["$animate",function(o){return function(e,n,t){e.$watch(t.animateNewElement,function(e,t){var i;!0===e&&(console.log(n),o.addClass(n,i="new-element",function(){o.removeClass(n,i)}))})}}]),directives.directive("hoverOnParent",[function(){return{restrict:"A",link:function(e,t,i){i=i.hoverOnParent;t.parent(i).bind("mouseenter",function(){t.addClass("btn-link-hover")}),t.parent(i).bind("mouseleave",function(){t.removeClass("btn-link-hover")})}}}]),directives.directive("coordinatePasting",function(){return{require:"ngModel",link:function(e,t,i,n){n.$setViewValue("0.12104"),n.$render()}}}),directives.directive("setFocus",["$timeout",function(n){return{restrict:"A",link:function(e,t,i){n(function(){n(function(){t[0].focus()})})}}}]),directives.directive("statisticsPanel",function(){return{restrict:"E",scope:{part:"="},templateUrl:"partials/statisticsTablePanel.html"}}),angular.module("seroApp.directives").directive("seroDeleteButton",["$sce",function(e){return{restrict:"E",scope:{onYes:"&",text:"=",warning:"=",buttonClass:"="},templateUrl:"partials/directives.deleteButton.html"}}]),seroApp.filter("myDateFormat",function(t){return function(e){if(!e)return"tom";e=new Date(e.replace(/-/g,"/"));return t("date")(e,"MMM-dd-yyyy")}});var version={version:"5.60.0"},services=angular.module("seroApp.services");services.value("version",version.version),services.factory("Practitioner",["$resource",function(e){return e("/api/v1/practitioner/:id",{id:"@id"},{update:{method:"PUT",isArray:!1}})}]),services.factory("Project",["$resource",function(e){return e("/api/v1/project/:projectId",{projectId:"@id"},{update:{method:"PUT",isArray:!1}})}]),services.factory("Organisation",["$resource",function(e){return e("/api/v1/organisation/:organisationId",{organisationId:"@id"},{update:{method:"PUT",isArray:!1}})}]),services.factory("EiaPermit",["$resource",function(e){return e("/api/v1/project/:projectId/eiapermit/:eiapermitId",{eiapermitId:"@id"},{update:{method:"PUT",isArray:!1}})}]),services.factory("Document",["$resource",function(e){return e("/api/v1/project/:projectId/eiapermit/:eiapermitId/document/:documentId",{documentId:"@id"},{update:{method:"PUT",isArray:!1}})}]),services.factory("Hearing",["$resource",function(e){return e("/api/v1/project/:projectId/eiapermit/:eiapermitId/document/:documentId/hearing/:hearingId",{hearingId:"@id"},{update:{method:"PUT",isArray:!1}})}]),services.factory("PermitLicense",["$resource",function(e){return e("/api/v1/project/:projectId/permitlicense/:permitlicenseId",{permitLicenseId:"@id"},{update:{method:"PUT",isArray:!1}})}]),services.factory("ExternalAudit",["$resource",function(e){return e("/api/v1/project/:projectId/externalaudit/:externalauditId",{externalauditId:"@id"},{update:{method:"PUT",isArray:!1}})}]),services.factory("DocumentEA",["$resource",function(e){return e("/api/v1/project/:projectId/externalaudit/:externalauditId/document/:documentId",{documentId:"@id"},{update:{method:"PUT",isArray:!1}})}]),services.factory("AuditInspection",["$resource",function(e){return e("/api/v1/project/:projectId/auditinspection/:auditinspectionId",{auditinspectionId:"@id"},{update:{method:"PUT",isArray:!1}})}]),services.factory("Valuelist",["$resource",function(e){return e("/api/v1/valuelist/:id",{id:"@id"})}]),services.factory("EnvInfo",["$http",function(e){return function(t){e.get("/env").success(function(e){return t(e)})}}]),services.factory("Valuelists",["Valuelist",function(e){return e.get({id:"all"})}]),services.factory("UserInfo",["$http","$location",function(t,i){function n(e){e?(_.merge(o.info,e),"/login"==i.path()&&i.path("/")):o.info=_.cloneDeep(r)}function e(){t.get("/user/info").success(n)}var o={info:{}},r={name:"Not signed in",role_1:!1,role_2:!1,role_3:!1,role_4:!1,role_5:!1,role_6:!1,role_7:!1,role_8:!1,roles:[],features:[]};return o.impersonate=function(e){n(null),t.get("/user/impersonate/"+e).success(n)},o.signout=function(){t.get("/auth/logout").success(function(){n(null),i.path("/login")})},o.getAllUsers=function(){t.get("/user/all").success(function(e){o.allusers=e})},o.reTry=function(){e()},n(null),e(),o}]),services.factory("EditCode",["$resource",function(e){return e("/edit/v1/code/:codeId",{codeId:"@id"},{update:{method:"PUT",isArray:!1}})}]),services.factory("EditUser",["$resource",function(e){return e("/edit/v1/user/:userId",{userId:"@id"},{update:{method:"PUT",isArray:!1}})}]),services.factory("EditEmailOrder",["$resource",function(e){return e("/edit/v1/emailOrder/:emailOrderId",{emailOrderId:"@id"},{update:{method:"PUT",isArray:!1}})}]),services.factory("EditLeadAgency",["$resource",function(e){return e("/edit/v1/leadagency/:leadAgencyId",{leadAgencyId:"@id"},{update:{method:"PUT",isArray:!1}})}]),services.factory("EiaPermitSearch",["$resource",function(e){return e("/search/v1/eiapermit")}]),services.factory("PermitLicenseSearch",["$resource",function(e){return e("/search/v1/permitlicense")}]),services.factory("ExternalAuditSearch",["$resource",function(e){return e("/search/v1/externalaudit")}]),services.factory("AuditInspectionSearch",["$resource",function(e){return e("/search/v1/auditinspection")}]),services.factory("ProjectSearch",["$resource",function(e){return e("/search/v1/project")}]),services.factory("ProjectStatistics",["$resource",function(e){return e("/statistics/v1/project")}]),services.factory("GeneralStatistics",["$resource",function(e){return e("/statistics/v1/general")}]),services.factory("EiaPermitSearchService",["EiaPermitSearch","$q",function(i,n){var o={criteria:{},allowCache:!0,rows:[],search:function(e){var t=n.defer();return _.isEqual(o.criteria,e)&&o.allowCache?t.resolve(o.rows):(o.criteria=_.clone(e),i.query(o.criteria,function(e){o.rows=e,t.resolve(o.rows),o.allowCache=!0})),t.promise}};return o}]),services.factory("PermitLicenseSearchService",["PermitLicenseSearch","$q",function(i,n){var o={criteria:{},allowCache:!0,rows:[],search:function(e){var t=n.defer();return _.isEqual(o.criteria,e)&&o.allowCache?t.resolve(o.rows):(o.criteria=_.clone(e),i.query(o.criteria,function(e){o.rows=e,t.resolve(o.rows),o.allowCache=!0})),t.promise}};return o}]),services.factory("ExternalAuditSearchService",["ExternalAuditSearch","$q",function(i,n){var o={criteria:{},allowCache:!0,rows:[],search:function(e){var t=n.defer();return _.isEqual(o.criteria,e)&&o.allowCache?t.resolve(o.rows):(o.criteria=_.clone(e),i.query(o.criteria,function(e){o.rows=e,t.resolve(o.rows),o.allowCache=!0})),t.promise}};return o}]),services.factory("SearchService",["AuditInspectionSearch","$q",function(i,n){var o={criteria:{},allowCache:!0,rows:[],search:function(e){var t=n.defer();return _.isEqual(o.criteria,e)&&o.allowCache?t.resolve(o.rows):(o.criteria=_.clone(e),i.query(o.criteria,function(e){o.rows=e,t.resolve(o.rows),o.allowCache=!0})),t.promise}};return o}]),services.factory("ProjectSearchService",["ProjectSearch","$q",function(i,n){var o={criteria:{},allowCache:!0,rows:[],search:function(e){var t=n.defer();return _.isEqual(o.criteria,e)&&o.allowCache?t.resolve(o.rows):(o.criteria=_.clone(e),i.query(o.criteria,function(e){o.rows=e,t.resolve(o.rows),o.allowCache=!0})),t.promise}};return o}]),services.factory("StatisticsService",["ProjectStatistics","$q",function(i,n){var o={allowCache:!0,projectData:{},getProjectData:function(e){var t=n.defer();return o.allowCache&&!_.isEmpty(o.projectData)?t.resolve(o.projectData):i.get({},function(e){o.projectData=e,t.resolve(e)}),t.promise}};return o}]);var data1={};services.factory("ProjectFactory",["$q","$filter","Project","Organisation","EiaPermit","Document","Hearing","ExternalAudit","DocumentEA","AuditInspection","Valuelists","UserInfo","PermitLicense",function(s,e,c,d,l,o,r,u,a,p,t,i,m){var f={project:{},organisation:{},eiaspermits:[],eiapermit:{},documents:[],document:{},hearings:[],hearing:{},permitslicenses:[],permitlicense:{},externalaudits:[],externalaudit:{},documents_ea:[],document_ea:{},auditsinspections:[],auditinspection:{}};return f.valuelists=t,f.userinfo=i,f.hasData={eiapermits:!1,eiapermit:!1,documents:!1,document:!1,hearings:!1,hearing:!1,permitslicenses:!1,permitlicense:!1,externalaudits:!1,externalaudit:!1,documents_ea:!1,document_ea:!1},f.retrieveProjectData=function(e){var t=s.defer(),i=s.defer(),n=s.defer(),o=s.defer(),r=s.defer(),a=s.defer();return f.project.id!=e.projectId?(e=_.omit(e,["eiapermitId","externalauditId","documentId","hearingId","permitlicenseId","auditinspectionId"]),f.empty(),f.project=c.get(e,function(e){t.resolve(e),f.organisation=d.get({organisationId:e.organisation_id},function(e){i.resolve(e)})}),f.eiaspermits=l.query(e,function(e){n.resolve(e)}),f.permitslicenses=m.query(e,function(e){a.resolve(e)}),f.externalaudits=u.query(e,function(e){o.resolve(e)}),f.auditsinspections=p.query(e,function(e){r.resolve(e)})):(_.remove(f.permitslicenses,function(e){return e.is_new}),t.resolve(f.project),i.resolve(f.organisation),n.resolve(f.eiaspermits),a.resolve(f.permitslicenses),o.resolve(f.externalaudits),r.resolve(f.auditsinspections)),[t.promise,i.promise,n.promise,r.promise,a.promise,o.promise]},f.retrieveEiaPermit=function(t){var e,i=s.defer(),n=s.defer();return f.eiapermit.id!=t.eiapermitId?(f.emptyEiaPermit(),1==(e=_.where(f.eiaspermits,{id:parseInt(t.eiapermitId)})).length&&(f.eiapermit=e[0],f.eiapermit.$get(_.omit(t,["documentId","hearingId"]),function(e){i.resolve(e),f.documents=o.query(_.omit(t,["documentId","hearingId"]),function(e){n.resolve(e)})}))):(i.resolve(f.eiapermit),n.resolve(f.documents)),[i.promise,n.promise]},f.retrieveDocument=function(t){var e,i=s.defer(),n=s.defer();return f.document.id!=t.documentId?(f.emptyDocument(),1==(e=_.where(f.documents,{id:parseInt(t.documentId)})).length&&(f.document=e[0],f.document.$get(_.omit(t,["hearingId"]),function(e){f.hearings=r.query(_.omit(t,["hearingId"]),function(e){n.resolve(e)}),i.resolve(e)}))):(i.resolve(f.document),n.resolve(f.hearings)),[i.promise,n.promise]},f.retrieveHearing=function(e){var t,i=s.defer();return f.hearing.id!=e.hearingId?(f.emptyHearing(),1==(t=_.where(f.hearings,{id:parseInt(e.hearingId)})).length&&(f.hearing=t[0],f.hearing.$get(e,function(e){i.resolve(e)}))):i.resolve(f.hearing),[i.promise]},f.retrieveExternalAudit=function(t){var i=s.defer(),n=s.defer();f.emptyExternalAudit();var e=_.where(f.externalaudits,{id:parseInt(t.externalauditId)});return 1==e.length&&(f.externalaudit=e[0],f.externalaudit.$get(_.omit(t,["documentId"]),function(e){f.documents_ea=a.query(_.omit(t,["documentId"]),function(e){n.resolve(e)}),i.resolve(e)})),[i.promise,n.promise]},f.retrieveDocumentEA=function(e){var t,i=s.defer();return f.document_ea.id!=e.documentId?(f.emptyDocumentEA(),1==(t=_.where(f.documents_ea,{id:parseInt(e.documentId)})).length&&(f.document_ea=t[0],f.document_ea.$get(_.omit(e,["hearingId"]),function(e){i.resolve(e)}))):i.resolve(f.document_ea),[i.promise]},f.retrieveAuditInspection=function(e){var t,i=s.defer();return!e.auditinspectionId||1==(t=_.where(f.auditsinspections,{id:parseInt(e.auditinspectionId)})).length&&(f.auditinspection=t[0],f.auditinspection.$get(e,function(e){i.resolve(e)})),[i.promise]},f.retrievePermitLicense=function(e){data1=f.permitslicenses;var t,i=s.defer();return!e.permitlicenseId||1==(t=_.where(f.permitslicenses,{id:parseInt(e.permitlicenseId)})).length&&(f.permitlicense=t[0],f.permitlicense.$get(e,function(e){i.resolve(e)})),[i.promise]},f.getProjectSummary=function(e){var t=f.project;return t.title||""},f.getCodeFromValuelist=function(e,t){"string"==typeof t&&(t=parseInt(t));t=_.find(f.valuelists[e],{id:t});return t?t.description1:""},f.setOrganisation=function(e){var t=s.defer();return e=new d(e),(f.organisation=e).$get({},function(e){t.resolve(e)}),t.promise},f.setEiaPermit=function(e){var t=s.defer();return f.eiapermit=e,t.resolve(e),t.promise},f.setAuditInspection=function(e){var t=s.defer();return f.auditinspection=e,t.resolve(e),t.promise},f.empty=function(){f.project={},f.organisation={},f.eiaspermits=[],f.emptyEiaPermit(),f.emptyExternalAudit(),f.auditsinspections=[],f.auditinspection={}},f.emptyEiaPermit=function(){f.eiapermit={},f.documents=[],f.emptyDocument()},f.emptyDocument=function(){f.document={},f.hearings=[],f.emptyHearing()},f.emptyHearing=function(){f.hearing={}},f.emptyExternalAudit=function(){f.externalaudit={},f.documents_ea=[],f.emptyDocumentEA()},f.emptyDocumentEA=function(){f.document_ea={}},f.createNewProject=function(e){e={has_industrial_waste_water:42,organisation_id:e.id,risk_level:null,is_new:!0};f.project=new c(e)},f.createNewOrganisation=function(){f.organisation=new d({is_new:!0})},f.createNewEiaPermit=function(e){e={project_id:e.id,inspection_recommended:42,is_new:!0};f.eiapermit=new l(e),f.eiaspermits.push(f.eiapermit),f.documents=[]},f.createNewDocument=function(e){e={eia_permit_id:e.id,director_copy_no:1,is_new:!0,date_next_appointment:window.getAppointmentDate()};f.document=new o(e),f.documents.unshift(f.document),f.hearings=[]},f.createNewHearing=function(e){e={document_id:e.id,is_new:!0};f.hearing=new r(e),f.hearings.unshift(f.hearing)},f.deleteEiaPermit=function(e){function t(e){f.eiaspermits.splice(e,1),f.eiapermit={}}var i=_.findIndex(f.eiaspermits,{id:f.eiapermit.id});f.eiapermit.is_new?t(i):f.eiapermit.$delete(e,function(){t(i)})},f.deleteDocument=function(e){function t(e){f.documents.splice(e,1),f.document={}}var i,n=s.defer();return f.document.is_new?t(0):(i=_.findIndex(f.documents,{id:f.document.id}),f.document.$delete(e,function(){t(i),n.resolve()})),n.promise},f.moveDocument=function(e,t){var i=s.defer(),n=_.findIndex(f.documents,{id:f.document.id});return f.document.eia_permit_id=t,f.document.$update(e,function(e){f.documents.splice(n,1),f.document={},i.resolve(e)},function(){i.reject("Moving failed")}),i.promise},f.moveDocumentEA=function(e,t){var i=s.defer(),n=_.findIndex(f.documents_ea,{id:f.document_ea.id});return f.document_ea.external_audit_id=t,f.document_ea.$update(e,function(e){f.documents_ea.splice(n,1),f.document_ea={},i.resolve(e)},function(){i.reject("Moving failed")}),i.promise},f.deleteHearing=function(e){function t(e){f.hearings.splice(e,1),f.hearing={}}var i,n=s.defer();return f.hearing.is_new?t(0):(i=_.findIndex(f.hearings,{id:f.hearing.id}),f.hearing.$delete(e,function(){t(i),n.resolve()})),n.promise},f.createNewExternalAudit=function(e){e={project_id:e.id,is_new:!0};f.externalaudit=new u(e),f.externalaudits.push(f.externalaudit),f.documents_ea=[]},f.createNewDocumentEA=function(e){e={external_audit_id:e.id,director_copy_no:1,is_new:!0,date_next_appointment:window.getAppointmentDate()};f.document_ea=new a(e),f.documents_ea.unshift(f.document_ea)},f.deleteExternalAudit=function(e){function t(e){f.externalaudits.splice(e,1),f.externalaudit={}}var i=_.findIndex(f.externalaudits,{id:f.externalaudit.id});f.externalaudit.is_new?t(i):f.externalaudit.$delete(e,function(){t(i)})},f.deleteDocumentEA=function(e){function t(e){f.documents_ea.splice(e,1),f.document_ea={}}var i,n=s.defer();return f.document_ea.is_new?t(0):(i=_.findIndex(f.documents_ea,{id:f.document_ea.id}),f.document_ea.$delete(e,function(){t(i),n.resolve()})),n.promise},f.createNewAuditInspection=function(e,t,i,n,o){o={project_id:e.id,year:t,type:i,reason:n,date_carried_out:o,days:1,status:70,performance_level:47,lead_officer:f.userinfo.info.id,is_new:!0};f.auditinspection=new p(o),f.auditsinspections.push(f.auditinspection)},f.deleteAuditInspection=function(e){function t(e){f.auditsinspections.splice(e,1),0<f.auditsinspections.length?f.auditinspection=f.auditinspection[0]:f.auditinspection={}}var i=_.findIndex(f.auditsinspections,{id:f.auditinspection.id});f.auditinspection.is_new?t(i):f.auditinspection.$delete(e,function(){t(i)})},f.createNewPermitLicense=function(e,t,i,n,o,r,a,s,c){c={project_id:e.id,regulation:t,ecosystem:i,regulation_activity:n,area:o,unit:r,approved_by_the_lc1:a,approved_by_the_dec:s,waste_license_type:c,is_new:!0};f.permitlicense=new m(c),f.permitslicenses.push(f.permitlicense)},f.deletePermitLicense=function(e){function t(e){f.permitslicenses.splice(e,1),f.permitlicense={}}var i=_.findIndex(f.permitslicenses,{id:f.permitlicense.id});f.permitlicense.is_new?t(i):f.permitlicense.$delete(e,function(){t(i)})},f.deleteProject=function(e){function t(){f.project={},i.resolve()}var i=s.defer();return f.project.is_new?t():f.project.$delete(e,function(){t()}),i.promise},f.save=function(e,t){var i,n=s.defer();return t.is_new?(i=_.omit(e,function(e){return"new"==e}),t.$save(i,function(e){n.resolve(e)},function(){n.reject("Saving new failed")})):t.$update(e,function(e){n.resolve(e)},function(){n.reject("Saving exisiting failed")}),n.promise},f}]);var validations=angular.module("pax.validations");function isNumberInRange(e,t,i){return!(null!==e&&i<e)&&!(null!==t&&t<i)}function getColumns(e){var n=[];return $.each(e[0],function(e,t){var i={};i.headertext=e,i.datatype="string",i.datafield=e,n.push(i)}),n}validations.directive("decimal",function(){return{require:"ngModel",link:function(e,t,i,n){var o=i.min?parseFloat(i.min):null,r=i.max?parseFloat(i.max):null,a=i.decimal?"{0,"+parseInt(i.decimal)+"}":"+",s=i.negativeNumber?"\\-?":"",c=new RegExp("^"+s+"\\d+((\\.|\\,)\\d"+a+")?$");n.$parsers.push(function(e,t){if(n.$isEmpty(e))return null;e=e.toString().trim().replace(",","."),e=parseFloat(e);return n.$isEmpty(e)?void 0:e}),n.$formatters.push(function(e){if(n.$isEmpty(e)||!i.decimal)return e;var t=parseInt(i.decimal);return _.round(parseFloat(e),t).toFixed(t)}),n.$validators.decimalInRange=function(e,t){return!!n.$isEmpty(e)||!!c.test(t)&&isNumberInRange(o,r,t)}}}}),validations.directive("integer",function(){return{require:"ngModel",link:function(e,t,i,n){var o=i.min?parseInt(i.min):null,r=i.max?parseInt(i.max):null,i=i.negativeNumber?"\\-?":"",a=new RegExp("^"+i+"\\d+$");n.$validators.integerInRange=function(e,t){return!!n.$isEmpty(e)||!!a.test(t)&&isNumberInRange(o,r,t)}}}}),validations.directive("certificateNumber",function(){return{require:"ngModel",link:function(e,t,i,n){var o=new RegExp("^CC/(EIA|EA|EP|FP)/[0-9]{3}/[0-9]{2}$");n.$validators.certificateNumber=function(e,t){return!!n.$isEmpty(e)||o.test(t)}}}}),function(a){var s={containerid:null,datatype:"table",dataset:null,columns:null,returnUri:!0,locale:"en-US",worksheetName:"My Worksheet",encoding:"utf-8"},c=s;a.fn.excelexportjs=function(e){c=a.extend({},s,e);var t,o=[];return function(){var e=c.datatype.toLowerCase();switch(function(e){switch(e){case"table":break;case"json":o=c.dataset;break;case"xml":a(c.dataset).find("row").each(function(e,t){var i={};null!=this.attributes&&0<this.attributes.length&&(a(this.attributes).each(function(){i[this.name]=this.value}),o.push(i))});break;case"jqgrid":a(c.dataset).find("rows > row").each(function(e,t){var i={};null!=this.children&&0<this.children.length&&(a(this.children).each(function(){i[this.tagName]=a(this).text()}),o.push(i))})}}(e),e){case"table":t=n(a("<div>").append(a("#"+c.containerid).clone()).html());break;case"json":case"xml":case"jqgrid":t=n(i())}{if(c.returnUri)return t;r()||window.open(t)}}();function i(){var n="<table id='tabledata' style='table-layout:inherit;white-space: nowrap;'>";return n+="<thead><tr>",a(c.columns).each(function(e,t){1!=this.ishidden&&(n+="<th",this.width,n+=">",n+=this.headertext,n+="</th>")}),n+="</tr></thead>",n+="<tbody>",a(o).each(function(e,i){n+="<tr>",a(c.columns).each(function(e,t){i.hasOwnProperty(this.datafield)&&1!=this.ishidden&&(n+="<td",n+=">",n+=i[this.datafield],n+="</td>")}),n+="</tr>"}),n+="</tbody>",n+="</table>"}function n(e){if(!r()){var t="<html xml:lang="+s.locale+" xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:x='urn:schemas-microsoft-com:office:excel' xmlns='http://www.w3.org/TR/REC-html40'>";t+="<head>",t+='<meta http-equiv="Content-type" content="text/html;charset='+s.encoding+'" />',t+="\x3c!--[if gte mso 9]>",t+="<xml>",t+="<x:ExcelWorkbook>",t+="<x:ExcelWorksheets>",t+="<x:ExcelWorksheet>",t+="<x:Name>",t+="{worksheet}",t+="</x:Name>",t+="<x:WorksheetOptions>",t+="<x:DisplayGridlines/>",t+="</x:WorksheetOptions>",t+="</x:ExcelWorksheet>",t+="</x:ExcelWorksheets>",t+="</x:ExcelWorkbook>",t+="</xml>",t+="<![endif]--\x3e",t+="</head>",t+="<body>",t+=e.replace(/"/g,"'"),t+="</body>";var i={worksheet:c.worksheetName,table:e};return n=i,t=(t+="</html>").replace(/{(\w+)}/g,function(e,t){return n[t]}),window.btoa(unescape(encodeURIComponent(t)))}var n;!function(e){var t=document.createElement("div");t.innerHTML=e;var i,n="<table border='2px'><tr bgcolor='#87AFC6'>",o=0;i="table"==c.datatype.toLowerCase()?document.getElementById(c.containerid):t.children[0];for(o=0;o<i.rows.length;o++)n=n+i.rows[o].innerHTML+"</tr>";n=(n=(n=(n+="</table>").replace(/<A[^>]*>|<\/A>/g,"")).replace(/<img[^>]*>/gi,"")).replace(/<input[^>]*>|<\/input>/gi,""),sa=0<window.navigator.userAgent.indexOf("MSIE ")||navigator.userAgent.match(/Trident.*rv\:11\./)?(txtArea1.document.open("txt/html","replace"),txtArea1.document.write(n),txtArea1.document.close(),txtArea1.focus(),txtArea1.document.execCommand("SaveAs",!0,c.worksheetName+".xlsx")):window.open("data:application/vnd.ms-excel,"+encodeURIComponent(n));sa}(e)}function r(){return 0<(!!navigator.userAgent.match(/Trident/g)||!!navigator.userAgent.match(/MSIE/g))}}}(jQuery);var excelExport=function(e,t,i){e=exportHelpers.reformatDateFields(e,t.dateFields),e=exportHelpers.renameFields(e,t.fieldmap),e=exportHelpers.sortObj(e,Object.values(t.fieldmap)),e=exportHelpers.replaceNullValues(e);var n=$("#dvjson").excelexportjs({containerid:"dvjson",datatype:"json",dataset:e,columns:getColumns(e),worksheetName:""}),t=new Date,e=t.getDate()+"."+(t.getMonth()+1)+"."+t.getFullYear()+"_"+t.getHours()+"."+t.getMinutes(),t=exportHelpers.b64toBlob(n,"application/vnd.ms-excel"),n=URL.createObjectURL(t),t=document.createElement("a"),t=document.body.appendChild(t);t.href=n,t.download=i+"_"+e+".xls",t.click()},exportHelpers={renameFields:function(e,t){var i,n=(e=JSON.parse(JSON.stringify(e))).length;for(i in t)if(t.hasOwnProperty(i))for(var o=t[i],r=0;r<n;r++){var a=e[r][i];e[r][o]=a,delete e[r][i]}return e},removeFields:function(e,t){for(var i=(e=JSON.parse(JSON.stringify(e))).length,n=0;n<i;n++){var o,r=e[n];for(o in r)r.hasOwnProperty(o)&&t.includes(o)&&delete e[n][o]}return e},reformatDateFields:function(e,t){for(var i,n=[],o=0;o<e.length;o++){var r,a=e[o];for(r in a)a.hasOwnProperty(r)&&t.includes(r)&&(a[r]=(i=a[r])&&i.split("-").reverse().join("-"));n.push(a)}return n},replaceNullValues:function(e){for(var t=[],i=0;i<e.length;i++){var n,o=e[i];if("object"==typeof o){for(var r in o)o.hasOwnProperty(r)&&(null==(n=o[r])||""==n?o[r]="NA":(o[r]=o[r]+"",o[r]=o[r].trim()));t.push(o)}}return t},sortObj:function(e,t){for(var e=JSON.parse(JSON.stringify(e)),i=[],n=0;n<e.length;n++){for(var o=e[n],r={},a=0;a<t.length;a++){var s=t[a];r[s]=o[s]}i.push(r)}return i},b64toBlob:function(e,t){for(var i=atob(e),n=[],o=0;o<i.length;o+=512){for(var r=i.slice(o,o+512),a=new Array(r.length),s=0;s<r.length;s++)a[s]=r.charCodeAt(s);var c=new Uint8Array(a);n.push(c)}return new Blob(n,{type:t})}};if(window.interceptPageNavigation=function(){var e=document.getElementsByTagName("a");window.globalWordCount="",document.addEventListener("keypress",function(e){e=e.which;(97<=parseInt(e)&&parseInt(e)<=122||65<=parseInt(e)&&parseInt(e)<=90||48<=parseInt(e)&&parseInt(e)<=57)&&(window.globalWordCount=e)});for(var t=e.length,i=0;i<t;i++);},window.interceptPageNavigation(),"undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");!function(){var e=jQuery.fn.jquery.split(" ")[0].split(".");if(e[0]<2&&e[1]<9||1==e[0]&&9==e[1]&&e[2]<1||3<e[0])throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher, but lower than version 4")}(),function(n){n.fn.emulateTransitionEnd=function(e){var t=!1,i=this;return n(this).one("bsTransitionEnd",function(){t=!0}),setTimeout(function(){t||n(i).trigger(n.support.transition.end)},e),this},n(function(){n.support.transition=function(){var e,t=document.createElement("bootstrap"),i={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(e in i)if(void 0!==t.style[e])return{end:i[e]};return!1}(),n.support.transition&&(n.event.special.bsTransitionEnd={bindType:n.support.transition.end,delegateType:n.support.transition.end,handle:function(e){if(n(e.target).is(this))return e.handleObj.handler.apply(this,arguments)}})})}(jQuery),function(r){function a(e){r(e).on("click",t,this.close)}var t='[data-dismiss="alert"]';a.VERSION="3.4.1",a.TRANSITION_DURATION=150,a.prototype.close=function(e){var t=r(this),i=t.attr("data-target");i="#"===(i=i||(i=t.attr("href"))&&i.replace(/.*(?=#[^\s]*$)/,""))?[]:i;var n=r(document).find(i);function o(){n.detach().trigger("closed.bs.alert").remove()}e&&e.preventDefault(),(n=!n.length?t.closest(".alert"):n).trigger(e=r.Event("close.bs.alert")),e.isDefaultPrevented()||(n.removeClass("in"),r.support.transition&&n.hasClass("fade")?n.one("bsTransitionEnd",o).emulateTransitionEnd(a.TRANSITION_DURATION):o())};var e=r.fn.alert;r.fn.alert=function(i){return this.each(function(){var e=r(this),t=e.data("bs.alert");t||e.data("bs.alert",t=new a(this)),"string"==typeof i&&t[i].call(e)})},r.fn.alert.Constructor=a,r.fn.alert.noConflict=function(){return r.fn.alert=e,this},r(document).on("click.bs.alert.data-api",t,a.prototype.close)}(jQuery),function(r){function n(e,t){this.$element=r(e),this.options=r.extend({},n.DEFAULTS,t),this.isLoading=!1}function i(i){return this.each(function(){var e=r(this),t=e.data("bs.button");t||e.data("bs.button",t=new n(this,"object"==typeof i&&i)),"toggle"==i?t.toggle():i&&t.setState(i)})}n.VERSION="3.4.1",n.DEFAULTS={loadingText:"loading..."},n.prototype.setState=function(e){var t="disabled",i=this.$element,n=i.is("input")?"val":"html",o=i.data();e+="Text",null==o.resetText&&i.data("resetText",i[n]()),setTimeout(r.proxy(function(){i[n]((null==o[e]?this.options:o)[e]),"loadingText"==e?(this.isLoading=!0,i.addClass(t).attr(t,t).prop(t,!0)):this.isLoading&&(this.isLoading=!1,i.removeClass(t).removeAttr(t).prop(t,!1))},this),0)},n.prototype.toggle=function(){var e,t=!0,i=this.$element.closest('[data-toggle="buttons"]');i.length?("radio"==(e=this.$element.find("input")).prop("type")?(e.prop("checked")&&(t=!1),i.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==e.prop("type")&&(e.prop("checked")!==this.$element.hasClass("active")&&(t=!1),this.$element.toggleClass("active")),e.prop("checked",this.$element.hasClass("active")),t&&e.trigger("change")):(this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active"))};var e=r.fn.button;r.fn.button=i,r.fn.button.Constructor=n,r.fn.button.noConflict=function(){return r.fn.button=e,this},r(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(e){var t=r(e.target).closest(".btn");i.call(t,"toggle"),r(e.target).is('input[type="radio"], input[type="checkbox"]')||(e.preventDefault(),(t.is("input,button")?t:t.find("input:visible,button:visible").first()).trigger("focus"))}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(e){r(e.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(e.type))})}(jQuery),function(d){function l(e,t){this.$element=d(e),this.$indicators=this.$element.find(".carousel-indicators"),this.options=t,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",d.proxy(this.keydown,this)),"hover"!=this.options.pause||"ontouchstart"in document.documentElement||this.$element.on("mouseenter.bs.carousel",d.proxy(this.pause,this)).on("mouseleave.bs.carousel",d.proxy(this.cycle,this))}function o(o){return this.each(function(){var e=d(this),t=e.data("bs.carousel"),i=d.extend({},l.DEFAULTS,e.data(),"object"==typeof o&&o),n="string"==typeof o?o:i.slide;t||e.data("bs.carousel",t=new l(this,i)),"number"==typeof o?t.to(o):n?t[n]():i.interval&&t.pause().cycle()})}l.VERSION="3.4.1",l.TRANSITION_DURATION=600,l.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},l.prototype.keydown=function(e){if(!/input|textarea/i.test(e.target.tagName)){switch(e.which){case 37:this.prev();break;case 39:this.next();break;default:return}e.preventDefault()}},l.prototype.cycle=function(e){return e||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(d.proxy(this.next,this),this.options.interval)),this},l.prototype.getItemIndex=function(e){return this.$items=e.parent().children(".item"),this.$items.index(e||this.$active)},l.prototype.getItemForDirection=function(e,t){var i=this.getItemIndex(t);if(("prev"==e&&0===i||"next"==e&&i==this.$items.length-1)&&!this.options.wrap)return t;e=(i+("prev"==e?-1:1))%this.$items.length;return this.$items.eq(e)},l.prototype.to=function(e){var t=this,i=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(!(e>this.$items.length-1||e<0))return this.sliding?this.$element.one("slid.bs.carousel",function(){t.to(e)}):i==e?this.pause().cycle():this.slide(i<e?"next":"prev",this.$items.eq(e))},l.prototype.pause=function(e){return e||(this.paused=!0),this.$element.find(".next, .prev").length&&d.support.transition&&(this.$element.trigger(d.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},l.prototype.next=function(){if(!this.sliding)return this.slide("next")},l.prototype.prev=function(){if(!this.sliding)return this.slide("prev")},l.prototype.slide=function(e,t){var i=this.$element.find(".item.active"),n=t||this.getItemForDirection(e,i),o=this.interval,r="next"==e?"left":"right",a=this;if(n.hasClass("active"))return this.sliding=!1;var s=n[0],t=d.Event("slide.bs.carousel",{relatedTarget:s,direction:r});if(this.$element.trigger(t),!t.isDefaultPrevented()){this.sliding=!0,o&&this.pause(),this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),(t=d(this.$indicators.children()[this.getItemIndex(n)]))&&t.addClass("active"));var c=d.Event("slid.bs.carousel",{relatedTarget:s,direction:r});return d.support.transition&&this.$element.hasClass("slide")?(n.addClass(e),"object"==typeof n&&n.length&&n[0].offsetWidth,i.addClass(r),n.addClass(r),i.one("bsTransitionEnd",function(){n.removeClass([e,r].join(" ")).addClass("active"),i.removeClass(["active",r].join(" ")),a.sliding=!1,setTimeout(function(){a.$element.trigger(c)},0)}).emulateTransitionEnd(l.TRANSITION_DURATION)):(i.removeClass("active"),n.addClass("active"),this.sliding=!1,this.$element.trigger(c)),o&&this.cycle(),this}};var e=d.fn.carousel;d.fn.carousel=o,d.fn.carousel.Constructor=l,d.fn.carousel.noConflict=function(){return d.fn.carousel=e,this};function t(e){var t=d(this),i=(i=t.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,""),n=t.attr("data-target")||i;(i=d(document).find(n)).hasClass("carousel")&&(n=d.extend({},i.data(),t.data()),(t=t.attr("data-slide-to"))&&(n.interval=!1),o.call(i,n),t&&i.data("bs.carousel").to(t),e.preventDefault())}d(document).on("click.bs.carousel.data-api","[data-slide]",t).on("click.bs.carousel.data-api","[data-slide-to]",t),d(window).on("load",function(){d('[data-ride="carousel"]').each(function(){var e=d(this);o.call(e,e.data())})})}(jQuery),function(o){function r(e,t){this.$element=o(e),this.options=o.extend({},r.DEFAULTS,t),this.$trigger=o('[data-toggle="collapse"][href="#'+e.id+'"],[data-toggle="collapse"][data-target="#'+e.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()}function i(e){var t=e.attr("data-target")||(t=e.attr("href"))&&t.replace(/.*(?=#[^\s]+$)/,"");return o(document).find(t)}function a(n){return this.each(function(){var e=o(this),t=e.data("bs.collapse"),i=o.extend({},r.DEFAULTS,e.data(),"object"==typeof n&&n);!t&&i.toggle&&/show|hide/.test(n)&&(i.toggle=!1),t||e.data("bs.collapse",t=new r(this,i)),"string"==typeof n&&t[n]()})}r.VERSION="3.4.1",r.TRANSITION_DURATION=350,r.DEFAULTS={toggle:!0},r.prototype.dimension=function(){return this.$element.hasClass("width")?"width":"height"},r.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var e=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(e&&e.length&&(n=e.data("bs.collapse"))&&n.transitioning)){var t=o.Event("show.bs.collapse");if(this.$element.trigger(t),!t.isDefaultPrevented()){e&&e.length&&(a.call(e,"hide"),n||e.data("bs.collapse",null));var i=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[i](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var n=function(){this.$element.removeClass("collapsing").addClass("collapse in")[i](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!o.support.transition)return n.call(this);e=o.camelCase(["scroll",i].join("-"));this.$element.one("bsTransitionEnd",o.proxy(n,this)).emulateTransitionEnd(r.TRANSITION_DURATION)[i](this.$element[0][e])}}}},r.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var e=o.Event("hide.bs.collapse");if(this.$element.trigger(e),!e.isDefaultPrevented()){var t=this.dimension();this.$element[t](this.$element[t]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;e=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};if(!o.support.transition)return e.call(this);this.$element[t](0).one("bsTransitionEnd",o.proxy(e,this)).emulateTransitionEnd(r.TRANSITION_DURATION)}}},r.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},r.prototype.getParent=function(){return o(document).find(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(o.proxy(function(e,t){t=o(t);this.addAriaAndCollapsedClass(i(t),t)},this)).end()},r.prototype.addAriaAndCollapsedClass=function(e,t){var i=e.hasClass("in");e.attr("aria-expanded",i),t.toggleClass("collapsed",!i).attr("aria-expanded",i)};var e=o.fn.collapse;o.fn.collapse=a,o.fn.collapse.Constructor=r,o.fn.collapse.noConflict=function(){return o.fn.collapse=e,this},o(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(e){var t=o(this);t.attr("data-target")||e.preventDefault();e=i(t),t=e.data("bs.collapse")?"toggle":t.data();a.call(e,t)})}(jQuery),function(o){function n(e){o(e).on("click.bs.dropdown",this.toggle)}var r='[data-toggle="dropdown"]';function a(e){var t=e.attr("data-target"),t="#"!==(t=t||(t=e.attr("href"))&&/#[A-Za-z]/.test(t)&&t.replace(/.*(?=#[^\s]*$)/,""))?o(document).find(t):null;return t&&t.length?t:e.parent()}function s(n){n&&3===n.which||(o(".dropdown-backdrop").remove(),o(r).each(function(){var e=o(this),t=a(e),i={relatedTarget:this};t.hasClass("open")&&(n&&"click"==n.type&&/input|textarea/i.test(n.target.tagName)&&o.contains(t[0],n.target)||(t.trigger(n=o.Event("hide.bs.dropdown",i)),n.isDefaultPrevented()||(e.attr("aria-expanded","false"),t.removeClass("open").trigger(o.Event("hidden.bs.dropdown",i)))))}))}n.VERSION="3.4.1",n.prototype.toggle=function(e){var t=o(this);if(!t.is(".disabled, :disabled")){var i=a(t),n=i.hasClass("open");if(s(),!n){"ontouchstart"in document.documentElement&&!i.closest(".navbar-nav").length&&o(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(o(this)).on("click",s);n={relatedTarget:this};if(i.trigger(e=o.Event("show.bs.dropdown",n)),e.isDefaultPrevented())return;t.trigger("focus").attr("aria-expanded","true"),i.toggleClass("open").trigger(o.Event("shown.bs.dropdown",n))}return!1}},n.prototype.keydown=function(e){if(/(38|40|27|32)/.test(e.which)&&!/input|textarea/i.test(e.target.tagName)){var t=o(this);if(e.preventDefault(),e.stopPropagation(),!t.is(".disabled, :disabled")){var i=a(t),n=i.hasClass("open");if(!n&&27!=e.which||n&&27==e.which)return 27==e.which&&i.find(r).trigger("focus"),t.trigger("click");t=i.find(".dropdown-menu li:not(.disabled):visible a");t.length&&(i=t.index(e.target),38==e.which&&0<i&&i--,40==e.which&&i<t.length-1&&i++,t.eq(i=!~i?0:i).trigger("focus"))}}};var e=o.fn.dropdown;o.fn.dropdown=function(i){return this.each(function(){var e=o(this),t=e.data("bs.dropdown");t||e.data("bs.dropdown",t=new n(this)),"string"==typeof i&&t[i].call(e)})},o.fn.dropdown.Constructor=n,o.fn.dropdown.noConflict=function(){return o.fn.dropdown=e,this},o(document).on("click.bs.dropdown.data-api",s).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",r,n.prototype.toggle).on("keydown.bs.dropdown.data-api",r,n.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",n.prototype.keydown)}(jQuery),function(r){function a(e,t){this.options=t,this.$body=r(document.body),this.$element=r(e),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.fixedContent=".navbar-fixed-top, .navbar-fixed-bottom",this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,r.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))}function s(n,o){return this.each(function(){var e=r(this),t=e.data("bs.modal"),i=r.extend({},a.DEFAULTS,e.data(),"object"==typeof n&&n);t||e.data("bs.modal",t=new a(this,i)),"string"==typeof n?t[n](o):i.show&&t.show(o)})}a.VERSION="3.4.1",a.TRANSITION_DURATION=300,a.BACKDROP_TRANSITION_DURATION=150,a.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},a.prototype.toggle=function(e){return this.isShown?this.hide():this.show(e)},a.prototype.show=function(i){var n=this,e=r.Event("show.bs.modal",{relatedTarget:i});this.$element.trigger(e),this.isShown||e.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',r.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){n.$element.one("mouseup.dismiss.bs.modal",function(e){r(e.target).is(n.$element)&&(n.ignoreBackdropClick=!0)})}),this.backdrop(function(){var e=r.support.transition&&n.$element.hasClass("fade");n.$element.parent().length||n.$element.appendTo(n.$body),n.$element.show().scrollTop(0),n.adjustDialog(),e&&n.$element[0].offsetWidth,n.$element.addClass("in"),n.enforceFocus();var t=r.Event("shown.bs.modal",{relatedTarget:i});e?n.$dialog.one("bsTransitionEnd",function(){n.$element.trigger("focus").trigger(t)}).emulateTransitionEnd(a.TRANSITION_DURATION):n.$element.trigger("focus").trigger(t)}))},a.prototype.hide=function(e){e&&e.preventDefault(),e=r.Event("hide.bs.modal"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),r(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),r.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",r.proxy(this.hideModal,this)).emulateTransitionEnd(a.TRANSITION_DURATION):this.hideModal())},a.prototype.enforceFocus=function(){r(document).off("focusin.bs.modal").on("focusin.bs.modal",r.proxy(function(e){document===e.target||this.$element[0]===e.target||this.$element.has(e.target).length||this.$element.trigger("focus")},this))},a.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",r.proxy(function(e){27==e.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},a.prototype.resize=function(){this.isShown?r(window).on("resize.bs.modal",r.proxy(this.handleUpdate,this)):r(window).off("resize.bs.modal")},a.prototype.hideModal=function(){var e=this;this.$element.hide(),this.backdrop(function(){e.$body.removeClass("modal-open"),e.resetAdjustments(),e.resetScrollbar(),e.$element.trigger("hidden.bs.modal")})},a.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},a.prototype.backdrop=function(e){var t,i=this,n=this.$element.hasClass("fade")?"fade":"";this.isShown&&this.options.backdrop?(t=r.support.transition&&n,this.$backdrop=r(document.createElement("div")).addClass("modal-backdrop "+n).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",r.proxy(function(e){this.ignoreBackdropClick?this.ignoreBackdropClick=!1:e.target===e.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide())},this)),t&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),e&&(t?this.$backdrop.one("bsTransitionEnd",e).emulateTransitionEnd(a.BACKDROP_TRANSITION_DURATION):e())):!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),t=function(){i.removeBackdrop(),e&&e()},r.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",t).emulateTransitionEnd(a.BACKDROP_TRANSITION_DURATION):t()):e&&e()},a.prototype.handleUpdate=function(){this.adjustDialog()},a.prototype.adjustDialog=function(){var e=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&e?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!e?this.scrollbarWidth:""})},a.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},a.prototype.checkScrollbar=function(){var e,t=window.innerWidth;t||(t=(e=document.documentElement.getBoundingClientRect()).right-Math.abs(e.left)),this.bodyIsOverflowing=document.body.clientWidth<t,this.scrollbarWidth=this.measureScrollbar()},a.prototype.setScrollbar=function(){var e=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"";var o=this.scrollbarWidth;this.bodyIsOverflowing&&(this.$body.css("padding-right",e+o),r(this.fixedContent).each(function(e,t){var i=t.style.paddingRight,n=r(t).css("padding-right");r(t).data("padding-right",i).css("padding-right",parseFloat(n)+o+"px")}))},a.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad),r(this.fixedContent).each(function(e,t){var i=r(t).data("padding-right");r(t).removeData("padding-right"),t.style.paddingRight=i||""})},a.prototype.measureScrollbar=function(){var e=document.createElement("div");e.className="modal-scrollbar-measure",this.$body.append(e);var t=e.offsetWidth-e.clientWidth;return this.$body[0].removeChild(e),t};var e=r.fn.modal;r.fn.modal=s,r.fn.modal.Constructor=a,r.fn.modal.noConflict=function(){return r.fn.modal=e,this},r(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(e){var t=r(this),i=t.attr("href"),n=t.attr("data-target")||i&&i.replace(/.*(?=#[^\s]+$)/,""),o=r(document).find(n),i=o.data("bs.modal")?"toggle":r.extend({remote:!/#/.test(i)&&i},o.data(),t.data());t.is("a")&&e.preventDefault(),o.one("show.bs.modal",function(e){e.isDefaultPrevented()||o.one("hidden.bs.modal",function(){t.is(":visible")&&t.trigger("focus")})}),s.call(o,i,this)})}(jQuery),function(m){var n=["sanitize","whiteList","sanitizeFn"],f=["background","cite","href","itemtype","longdesc","poster","src","xlink:href"],h=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:/?#]*(?:[/?#]|$))/gi,g=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+/]+=*$/i;function o(e,t,i){if(0===e.length)return e;if(i&&"function"==typeof i)return i(e);if(!document.implementation||!document.implementation.createHTMLDocument)return e;i=document.implementation.createHTMLDocument("sanitization");i.body.innerHTML=e;for(var n=m.map(t,function(e,t){return t}),o=m(i.body).find("*"),r=0,a=o.length;r<a;r++){var s=o[r],c=s.nodeName.toLowerCase();if(-1!==m.inArray(c,n))for(var d=m.map(s.attributes,function(e){return e}),l=[].concat(t["*"]||[],t[c]||[]),u=0,p=d.length;u<p;u++)!function(e,t){var i=e.nodeName.toLowerCase();if(-1!==m.inArray(i,t))return-1===m.inArray(i,f)||Boolean(e.nodeValue.match(h)||e.nodeValue.match(g));for(var n=m(t).filter(function(e,t){return t instanceof RegExp}),o=0,r=n.length;o<r;o++)if(i.match(n[o]))return 1}(d[u],l)&&s.removeAttribute(d[u].nodeName);else s.parentNode.removeChild(s)}return i.body.innerHTML}function c(e,t){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",e,t)}c.VERSION="3.4.1",c.TRANSITION_DURATION=150,c.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0},sanitize:!0,sanitizeFn:null,whiteList:{"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]}},c.prototype.init=function(e,t,i){if(this.enabled=!0,this.type=e,this.$element=m(t),this.options=this.getOptions(i),this.$viewport=this.options.viewport&&m(document).find(m.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var n=this.options.trigger.split(" "),o=n.length;o--;){var r,a=n[o];"click"==a?this.$element.on("click."+this.type,this.options.selector,m.proxy(this.toggle,this)):"manual"!=a&&(r="hover"==a?"mouseleave":"focusout",this.$element.on(("hover"==a?"mouseenter":"focusin")+"."+this.type,this.options.selector,m.proxy(this.enter,this)),this.$element.on(r+"."+this.type,this.options.selector,m.proxy(this.leave,this)))}this.options.selector?this._options=m.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},c.prototype.getDefaults=function(){return c.DEFAULTS},c.prototype.getOptions=function(e){var t,i=this.$element.data();for(t in i)i.hasOwnProperty(t)&&-1!==m.inArray(t,n)&&delete i[t];return(e=m.extend({},this.getDefaults(),i,e)).delay&&"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),e.sanitize&&(e.template=o(e.template,e.whiteList,e.sanitizeFn)),e},c.prototype.getDelegateOptions=function(){var i={},n=this.getDefaults();return this._options&&m.each(this._options,function(e,t){n[e]!=t&&(i[e]=t)}),i},c.prototype.enter=function(e){var t=e instanceof this.constructor?e:m(e.currentTarget).data("bs."+this.type);if(t||(t=new this.constructor(e.currentTarget,this.getDelegateOptions()),m(e.currentTarget).data("bs."+this.type,t)),e instanceof m.Event&&(t.inState["focusin"==e.type?"focus":"hover"]=!0),t.tip().hasClass("in")||"in"==t.hoverState)t.hoverState="in";else{if(clearTimeout(t.timeout),t.hoverState="in",!t.options.delay||!t.options.delay.show)return t.show();t.timeout=setTimeout(function(){"in"==t.hoverState&&t.show()},t.options.delay.show)}},c.prototype.isInStateTrue=function(){for(var e in this.inState)if(this.inState[e])return!0;return!1},c.prototype.leave=function(e){var t=e instanceof this.constructor?e:m(e.currentTarget).data("bs."+this.type);if(t||(t=new this.constructor(e.currentTarget,this.getDelegateOptions()),m(e.currentTarget).data("bs."+this.type,t)),e instanceof m.Event&&(t.inState["focusout"==e.type?"focus":"hover"]=!1),!t.isInStateTrue()){if(clearTimeout(t.timeout),t.hoverState="out",!t.options.delay||!t.options.delay.hide)return t.hide();t.timeout=setTimeout(function(){"out"==t.hoverState&&t.hide()},t.options.delay.hide)}},c.prototype.show=function(){var t,e,i,n,o,r,a,s=m.Event("show.bs."+this.type);this.hasContent()&&this.enabled&&(this.$element.trigger(s),i=m.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]),!s.isDefaultPrevented()&&i&&(e=(t=this).tip(),r=this.getUID(this.type),this.setContent(),e.attr("id",r),this.$element.attr("aria-describedby",r),this.options.animation&&e.addClass("fade"),a="function"==typeof this.options.placement?this.options.placement.call(this,e[0],this.$element[0]):this.options.placement,(o=(n=/\s?auto?\s?/i).test(a))&&(a=a.replace(n,"")||"top"),e.detach().css({top:0,left:0,display:"block"}).addClass(a).data("bs."+this.type,this),this.options.container?e.appendTo(m(document).find(this.options.container)):e.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type),s=this.getPosition(),i=e[0].offsetWidth,r=e[0].offsetHeight,o&&(n=a,o=this.getPosition(this.$viewport),a="bottom"==a&&s.bottom+r>o.bottom?"top":"top"==a&&s.top-r<o.top?"bottom":"right"==a&&s.right+i>o.width?"left":"left"==a&&s.left-i<o.left?"right":a,e.removeClass(n).addClass(a)),r=this.getCalculatedOffset(a,s,i,r),this.applyPlacement(r,a),a=function(){var e=t.hoverState;t.$element.trigger("shown.bs."+t.type),t.hoverState=null,"out"==e&&t.leave(t)},m.support.transition&&this.$tip.hasClass("fade")?e.one("bsTransitionEnd",a).emulateTransitionEnd(c.TRANSITION_DURATION):a()))},c.prototype.applyPlacement=function(e,t){var i=this.tip(),n=i[0].offsetWidth,o=i[0].offsetHeight,r=parseInt(i.css("margin-top"),10),a=parseInt(i.css("margin-left"),10);isNaN(r)&&(r=0),isNaN(a)&&(a=0),e.top+=r,e.left+=a,m.offset.setOffset(i[0],m.extend({using:function(e){i.css({top:Math.round(e.top),left:Math.round(e.left)})}},e),0),i.addClass("in");var s=i[0].offsetWidth,r=i[0].offsetHeight;"top"==t&&r!=o&&(e.top=e.top+o-r);a=this.getViewportAdjustedDelta(t,e,s,r);a.left?e.left+=a.left:e.top+=a.top;t=/top|bottom/.test(t),o=t?2*a.left-n+s:2*a.top-o+r,r=t?"offsetWidth":"offsetHeight";i.offset(e),this.replaceArrow(o,i[0][r],t)},c.prototype.replaceArrow=function(e,t,i){this.arrow().css(i?"left":"top",50*(1-e/t)+"%").css(i?"top":"left","")},c.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();this.options.html?(this.options.sanitize&&(t=o(t,this.options.whiteList,this.options.sanitizeFn)),e.find(".tooltip-inner").html(t)):e.find(".tooltip-inner").text(t),e.removeClass("fade in top bottom left right")},c.prototype.hide=function(e){var t=this,i=m(this.$tip),n=m.Event("hide.bs."+this.type);function o(){"in"!=t.hoverState&&i.detach(),t.$element&&t.$element.removeAttr("aria-describedby").trigger("hidden.bs."+t.type),e&&e()}if(this.$element.trigger(n),!n.isDefaultPrevented())return i.removeClass("in"),m.support.transition&&i.hasClass("fade")?i.one("bsTransitionEnd",o).emulateTransitionEnd(c.TRANSITION_DURATION):o(),this.hoverState=null,this},c.prototype.fixTitle=function(){var e=this.$element;!e.attr("title")&&"string"==typeof e.attr("data-original-title")||e.attr("data-original-title",e.attr("title")||"").attr("title","")},c.prototype.hasContent=function(){return this.getTitle()},c.prototype.getPosition=function(e){var t=(e=e||this.$element)[0],i="BODY"==t.tagName,n=t.getBoundingClientRect();null==n.width&&(n=m.extend({},n,{width:n.right-n.left,height:n.bottom-n.top}));t=window.SVGElement&&t instanceof window.SVGElement,t=i?{top:0,left:0}:t?null:e.offset(),e={scroll:i?document.documentElement.scrollTop||document.body.scrollTop:e.scrollTop()},i=i?{width:m(window).width(),height:m(window).height()}:null;return m.extend({},n,e,i,t)},c.prototype.getCalculatedOffset=function(e,t,i,n){return"bottom"==e?{top:t.top+t.height,left:t.left+t.width/2-i/2}:"top"==e?{top:t.top-n,left:t.left+t.width/2-i/2}:"left"==e?{top:t.top+t.height/2-n/2,left:t.left-i}:{top:t.top+t.height/2-n/2,left:t.left+t.width}},c.prototype.getViewportAdjustedDelta=function(e,t,i,n){var o={top:0,left:0};if(!this.$viewport)return o;var r,a=this.options.viewport&&this.options.viewport.padding||0,s=this.getPosition(this.$viewport);return/right|left/.test(e)?(e=t.top-a-s.scroll,r=t.top+a-s.scroll+n,e<s.top?o.top=s.top-e:r>s.top+s.height&&(o.top=s.top+s.height-r)):(r=t.left-a,i=t.left+a+i,r<s.left?o.left=s.left-r:i>s.right&&(o.left=s.left+s.width-i)),o},c.prototype.getTitle=function(){var e=this.$element,t=this.options;return e.attr("data-original-title")||("function"==typeof t.title?t.title.call(e[0]):t.title)},c.prototype.getUID=function(e){for(;e+=~~(1e6*Math.random()),document.getElementById(e););return e},c.prototype.tip=function(){if(!this.$tip&&(this.$tip=m(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},c.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},c.prototype.enable=function(){this.enabled=!0},c.prototype.disable=function(){this.enabled=!1},c.prototype.toggleEnabled=function(){this.enabled=!this.enabled},c.prototype.toggle=function(e){var t=this;e&&((t=m(e.currentTarget).data("bs."+this.type))||(t=new this.constructor(e.currentTarget,this.getDelegateOptions()),m(e.currentTarget).data("bs."+this.type,t))),e?(t.inState.click=!t.inState.click,t.isInStateTrue()?t.enter(t):t.leave(t)):t.tip().hasClass("in")?t.leave(t):t.enter(t)},c.prototype.destroy=function(){var e=this;clearTimeout(this.timeout),this.hide(function(){e.$element.off("."+e.type).removeData("bs."+e.type),e.$tip&&e.$tip.detach(),e.$tip=null,e.$arrow=null,e.$viewport=null,e.$element=null})},c.prototype.sanitizeHtml=function(e){return o(e,this.options.whiteList,this.options.sanitizeFn)};var e=m.fn.tooltip;m.fn.tooltip=function(n){return this.each(function(){var e=m(this),t=e.data("bs.tooltip"),i="object"==typeof n&&n;!t&&/destroy|hide/.test(n)||(t||e.data("bs.tooltip",t=new c(this,i)),"string"==typeof n&&t[n]())})},m.fn.tooltip.Constructor=c,m.fn.tooltip.noConflict=function(){return m.fn.tooltip=e,this}}(jQuery),function(o){function r(e,t){this.init("popover",e,t)}if(!o.fn.tooltip)throw new Error("Popover requires tooltip.js");r.VERSION="3.4.1",r.DEFAULTS=o.extend({},o.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),((r.prototype=o.extend({},o.fn.tooltip.Constructor.prototype)).constructor=r).prototype.getDefaults=function(){return r.DEFAULTS},r.prototype.setContent=function(){var e,t=this.tip(),i=this.getTitle(),n=this.getContent();this.options.html?(e=typeof n,this.options.sanitize&&(i=this.sanitizeHtml(i),"string"==e&&(n=this.sanitizeHtml(n))),t.find(".popover-title").html(i),t.find(".popover-content").children().detach().end()["string"==e?"html":"append"](n)):(t.find(".popover-title").text(i),t.find(".popover-content").children().detach().end().text(n)),t.removeClass("fade top bottom left right in"),t.find(".popover-title").html()||t.find(".popover-title").hide()},r.prototype.hasContent=function(){return this.getTitle()||this.getContent()},r.prototype.getContent=function(){var e=this.$element,t=this.options;return e.attr("data-content")||("function"==typeof t.content?t.content.call(e[0]):t.content)},r.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var e=o.fn.popover;o.fn.popover=function(n){return this.each(function(){var e=o(this),t=e.data("bs.popover"),i="object"==typeof n&&n;!t&&/destroy|hide/.test(n)||(t||e.data("bs.popover",t=new r(this,i)),"string"==typeof n&&t[n]())})},o.fn.popover.Constructor=r,o.fn.popover.noConflict=function(){return o.fn.popover=e,this}}(jQuery),function(o){function n(e,t){this.$body=o(document.body),this.$scrollElement=o(e).is(document.body)?o(window):o(e),this.options=o.extend({},n.DEFAULTS,t),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",o.proxy(this.process,this)),this.refresh(),this.process()}function t(i){return this.each(function(){var e=o(this),t=e.data("bs.scrollspy");t||e.data("bs.scrollspy",t=new n(this,"object"==typeof i&&i)),"string"==typeof i&&t[i]()})}n.VERSION="3.4.1",n.DEFAULTS={offset:10},n.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},n.prototype.refresh=function(){var e=this,i="offset",n=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),o.isWindow(this.$scrollElement[0])||(i="position",n=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var e=o(this),t=e.data("target")||e.attr("href"),e=/^#./.test(t)&&o(t);return e&&e.length&&e.is(":visible")?[[e[i]().top+n,t]]:null}).sort(function(e,t){return e[0]-t[0]}).each(function(){e.offsets.push(this[0]),e.targets.push(this[1])})},n.prototype.process=function(){var e,t=this.$scrollElement.scrollTop()+this.options.offset,i=this.getScrollHeight(),n=this.options.offset+i-this.$scrollElement.height(),o=this.offsets,r=this.targets,a=this.activeTarget;if(this.scrollHeight!=i&&this.refresh(),n<=t)return a!=(e=r[r.length-1])&&this.activate(e);if(a&&t<o[0])return this.activeTarget=null,this.clear();for(e=o.length;e--;)a!=r[e]&&t>=o[e]&&(void 0===o[e+1]||t<o[e+1])&&this.activate(r[e])},n.prototype.activate=function(e){this.activeTarget=e,this.clear();e=this.selector+'[data-target="'+e+'"],'+this.selector+'[href="'+e+'"]',e=o(e).parents("li").addClass("active");(e=e.parent(".dropdown-menu").length?e.closest("li.dropdown").addClass("active"):e).trigger("activate.bs.scrollspy")},n.prototype.clear=function(){o(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var e=o.fn.scrollspy;o.fn.scrollspy=t,o.fn.scrollspy.Constructor=n,o.fn.scrollspy.noConflict=function(){return o.fn.scrollspy=e,this},o(window).on("load.bs.scrollspy.data-api",function(){o('[data-spy="scroll"]').each(function(){var e=o(this);t.call(e,e.data())})})}(jQuery),function(a){function s(e){this.element=a(e)}function t(i){return this.each(function(){var e=a(this),t=e.data("bs.tab");t||e.data("bs.tab",t=new s(this)),"string"==typeof i&&t[i]()})}s.VERSION="3.4.1",s.TRANSITION_DURATION=150,s.prototype.show=function(){var e,t,i,n=this.element,o=n.closest("ul:not(.dropdown-menu)"),r=(r=n.data("target"))||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]*$)/,"");n.parent("li").hasClass("active")||(e=o.find(".active:last a"),t=a.Event("hide.bs.tab",{relatedTarget:n[0]}),i=a.Event("show.bs.tab",{relatedTarget:e[0]}),e.trigger(t),n.trigger(i),i.isDefaultPrevented()||t.isDefaultPrevented()||(r=a(document).find(r),this.activate(n.closest("li"),o),this.activate(r,r.parent(),function(){e.trigger({type:"hidden.bs.tab",relatedTarget:n[0]}),n.trigger({type:"shown.bs.tab",relatedTarget:e[0]})})))},s.prototype.activate=function(e,t,i){var n=t.find("> .active"),o=i&&a.support.transition&&(n.length&&n.hasClass("fade")||!!t.find("> .fade").length);function r(){n.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),e.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),o?(e[0].offsetWidth,e.addClass("in")):e.removeClass("fade"),e.parent(".dropdown-menu").length&&e.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),i&&i()}n.length&&o?n.one("bsTransitionEnd",r).emulateTransitionEnd(s.TRANSITION_DURATION):r(),n.removeClass("in")};var e=a.fn.tab;a.fn.tab=t,a.fn.tab.Constructor=s,a.fn.tab.noConflict=function(){return a.fn.tab=e,this};function i(e){e.preventDefault(),t.call(a(this),"show")}a(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',i).on("click.bs.tab.data-api",'[data-toggle="pill"]',i)}(jQuery),function(a){function s(e,t){this.options=a.extend({},s.DEFAULTS,t),t=this.options.target===s.DEFAULTS.target?a(this.options.target):a(document).find(this.options.target),this.$target=t.on("scroll.bs.affix.data-api",a.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",a.proxy(this.checkPositionWithEventLoop,this)),this.$element=a(e),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()}function i(i){return this.each(function(){var e=a(this),t=e.data("bs.affix");t||e.data("bs.affix",t=new s(this,"object"==typeof i&&i)),"string"==typeof i&&t[i]()})}s.VERSION="3.4.1",s.RESET="affix affix-top affix-bottom",s.DEFAULTS={offset:0,target:window},s.prototype.getState=function(e,t,i,n){var o=this.$target.scrollTop(),r=this.$element.offset(),a=this.$target.height();if(null!=i&&"top"==this.affixed)return o<i&&"top";if("bottom"==this.affixed)return null!=i?!(o+this.unpin<=r.top)&&"bottom":!(o+a<=e-n)&&"bottom";var s=null==this.affixed,r=s?o:r.top;return null!=i&&o<=i?"top":null!=n&&e-n<=r+(s?a:t)&&"bottom"},s.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(s.RESET).addClass("affix");var e=this.$target.scrollTop(),t=this.$element.offset();return this.pinnedOffset=t.top-e},s.prototype.checkPositionWithEventLoop=function(){setTimeout(a.proxy(this.checkPosition,this),1)},s.prototype.checkPosition=function(){if(this.$element.is(":visible")){var e=this.$element.height(),t=this.options.offset,i=t.top,n=t.bottom,o=Math.max(a(document).height(),a(document.body).height());"object"!=typeof t&&(n=i=t),"function"==typeof i&&(i=t.top(this.$element)),"function"==typeof n&&(n=t.bottom(this.$element));var r=this.getState(o,e,i,n);if(this.affixed!=r){null!=this.unpin&&this.$element.css("top","");t="affix"+(r?"-"+r:""),i=a.Event(t+".bs.affix");if(this.$element.trigger(i),i.isDefaultPrevented())return;this.affixed=r,this.unpin="bottom"==r?this.getPinnedOffset():null,this.$element.removeClass(s.RESET).addClass(t).trigger(t.replace("affix","affixed")+".bs.affix")}"bottom"==r&&this.$element.offset({top:o-e-n})}};var e=a.fn.affix;a.fn.affix=i,a.fn.affix.Constructor=s,a.fn.affix.noConflict=function(){return a.fn.affix=e,this},a(window).on("load",function(){a('[data-spy="affix"]').each(function(){var e=a(this),t=e.data();t.offset=t.offset||{},null!=t.offsetBottom&&(t.offset.bottom=t.offsetBottom),null!=t.offsetTop&&(t.offset.top=t.offsetTop),i.call(e,t)})})}(jQuery);